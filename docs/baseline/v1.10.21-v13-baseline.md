# v1.10.21 Baseline — Remove 90 Obsolete Detectors (v13)

**Date**: 2026-02-12
**Total Findings**: 440 across 18 test targets (down from 1,089 in v12)
**Clean Contract FPs**: 0 across 5 clean contracts (was 3 in v12)
**Tests Passing**: all pass, 0 failures
**TP Regressions**: 0 (77/77 TPs detected, 100% recall)
**Parse Errors**: 0 (all 117 contracts parse successfully)
**Detectors**: 245 (down from 335 in v12)

## Severity Breakdown

| Severity | v12 Count | v13 Count | Change |
|----------|-----------|-----------|--------|
| Critical | 300 | 119 | -181 |
| High | 540 | 217 | -323 |
| Medium | 184 | 101 | -83 |
| Low | 51 | 6 | -45 |
| Info | 14 | 0 | -14 |
| **Total** | **1,089** | **440** | **-649** |

## Per-Target Findings

| # | Target | v12 Findings | v13 Findings | Change |
|---|--------|-------------|-------------|--------|
| 1 | `clean_examples/clean_contract.sol` | 0 | 0 | 0 |
| 2 | `fp_benchmarks/safe_amm_pool.sol` | 2 | 0 | -2 |
| 3 | `fp_benchmarks/safe_chainlink_consumer.sol` | 0 | 0 | 0 |
| 4 | `fp_benchmarks/safe_erc4626_vault.sol` | 0 | 0 | 0 |
| 5 | `fp_benchmarks/safe_flash_loan_provider.sol` | 1 | 0 | -1 |
| 6 | `basic_vulnerabilities/reentrancy_issues.sol` | 2 | 2 | 0 |
| 7 | `basic_vulnerabilities/validation_issues.sol` | 3 | 1 | -2 |
| 8 | `vulnerable/` | 51 | 42 | -9 |
| 9 | `flash_loans/` | 23 | 7 | -16 |
| 10 | `erc4626_vaults/` | 43 | 26 | -17 |
| 11 | `price-manipulation/` | 135 | 29 | -106 |
| 12 | `cross_chain/` | 42 | 35 | -7 |
| 13 | `delegatecall/` | 372 | 102 | -270 |
| 14 | `signatures/` | 194 | 41 | -153 |
| 15 | `specialized/` | 69 | 58 | -11 |
| 16 | `restaking/` | 95 | 74 | -21 |
| 17 | `account_abstraction/` | 16 | 8 | -8 |
| 18 | `amm_context/` | 41 | 15 | -26 |
| | **TOTAL** | **1,089** | **440** | **-649** |

## v13 Changes: Remove 85 Obsolete Detectors

### Problem Statement

SolidityDefend carried 90 detectors that produced high false positive rates with zero validated true positives. Many were obsolete in 2026:

- **Dead post-EVM changes**: `contract-recreation-attack` (EIP-6780 killed SELFDESTRUCT recreation), `extcodesize-bypass`/`extcodesize-check-bypass` (EIP-7702), `timestamp-manipulation` (post-merge PoS)
- **Superseded by compiler**: `post-080-overflow` (Solidity 0.8+ checked arithmetic), `shadowing-variables` (compiler warning since 0.6.5)
- **Keyword-matching noise**: MEV detectors (`mev-toxic-flow-exposure`, `bundle-inclusion-leak`, `oracle-update-mev`, etc.) did string matching without actual data-flow analysis
- **Redundant**: Many overlapped with better-precision enabled detectors (e.g., `dangerous-delegatecall` covered by `delegatecall-untrusted-library` + `fallback-delegatecall-unprotected`)

### What Was Removed

**90 detector registrations removed** (81 source files deleted + 4 in shared modules):

| Category | Detectors Removed | Findings Eliminated |
|----------|-------------------|---------------------|
| Proxy/Upgrade | `proxy-double-initialize`, `proxy-upgrade-unprotected`, `proxy-gap-underflow`, `immutable-in-upgradeable`, `implementation-not-initialized`, `reinitializer-vulnerability`, `initializer-reentrancy`, `transparent-proxy-admin-issues`, `beacon-*`, `role-escalation-upgrade`, `upgrade-event-missing`, `missing-storage-gap` | ~80 |
| Diamond | `diamond-storage-collision`, `diamond-loupe-violation`, `diamond-delegatecall-zero`, `diamond-facet-code-existence`, `diamond-init-reentrancy` | ~60 |
| MEV/Frontrunning | `front-running-mitigation`, `sandwich-*`, `governance-proposal-mev`, `oracle-update-mev`, `cross-domain-mev`, `bundle-inclusion-leak`, `block-stuffing-vulnerable`, `token-launch-mev`, `order-flow-auction-abuse`, `mev-backrun-opportunities`, `mev-toxic-flow-exposure`, `validator-front-running`, `price-manipulation-frontrun` | ~40 |
| DeFi | `lending-*`, `price-impact-manipulation`, `price-oracle-stale`, `defi-jit-liquidity`, `defi-liquidity-pool-manipulation`, `amm-k-invariant-violation`, `sandwich-resistant-swap`, `flashloan-governance-attack` | ~30 |
| Code Quality | `shadowing-variables`, `redundant-checks`, `excessive-gas-usage`, `function-selector-clash` | ~25 |
| Security (obsolete) | `dangerous-delegatecall`, `delegatecall-in-loop`, `extcodesize-*`, `contract-recreation-attack`, `timestamp-manipulation`, `insufficient-randomness`, `multi-block-randomness`, `modulo-block-variable`, `batch-cross-function-reentrancy`, `voting-snapshot-manipulation`, `transaction-ordering-dependence` | ~80 |
| DoS | `dos-block-gas-limit`, `dos-failed-transfer`, `dos-push-pattern`, `dos-revert-bomb` | ~10 |
| Other | `external-calls-loop`, `parameter-consistency`, `enhanced-access-control`, `logic-error-patterns`, `post-080-overflow`, `multi-role-confusion`, `storage-*`, `operator-whitelist-inheritance`, `chainlink-vrf-misuse`, `challenge-period-bypass`, `cross-chain-*`, `multicall-partial-revert`, `l2-data-availability` | ~40 |

### Infrastructure Changes

- **Removed `DEFAULT_DISABLED` constant** and `apply_default_disabled()` method from `registry.rs`
- **Removed ~67 `pub mod` declarations** from `lib.rs`
- **Cleaned `fp_filter.rs`** — removed 9 dead detector ID prefixes from `ADMIN_SUPPRESSIBLE_PREFIXES`
- **Updated ground truth** — removed `flash-loan-governance-attack` TP entry (77 TPs, down from 78)
- **Updated documentation** — detector counts, changelog, `all_detectors.json`

### Clean File FP Improvements

The 3 pre-existing FPs on clean contracts were all from removed detectors:

| File | v12 FPs | v13 FPs | Removed Detector |
|------|---------|---------|------------------|
| `safe_amm_pool.sol` | 2 | 0 | `sandwich-resistant-swap`, `price-impact-manipulation` |
| `safe_flash_loan_provider.sol` | 1 | 0 | `flash-loan-governance-attack` |
| **Total** | **3** | **0** | |

### Verification

| Metric | v12 (Before) | v13 (After) | Change |
|--------|--------------|-------------|--------|
| Total Detectors | 335 | 245 | -90 |
| Total Findings (18 targets) | 1,089 | 440 | -649 (-59.6%) |
| Clean FPs | 3 | 0 | -3 (100%) |
| Parse Errors | 0 | 0 | 0 |
| Recall (TPs) | 78/78 | 77/77 | 100% |
| Tests | all pass | all pass | 0 failures |
| FP Audit | 2/2 pass | 2/2 pass | 0 |

### Full v1.10.x FP Reduction History (v1-v13)

| Metric | v1.10.19 (Start) | v10 | v12 | v13 (Current) | Total Change |
|--------|-------------------|-----|-----|---------------|--------------|
| Total Detectors | 335 | 335 | 335 | 245 | -90 |
| Total Findings | 1,776 | 1,089 | 1,089 | 440 | -1,336 (75.2%) |
| Clean FPs | 26 | 3 | 3 | 0 | -26 (100%) |
| Parse Errors | 3 | 0 | 0 | 0 | -3 (100%) |
| Recall (TPs) | -- | 78/78 | 78/78 | 77/77 | 100% |
| Contract Attribution | No | No | Yes | Yes | -- |
