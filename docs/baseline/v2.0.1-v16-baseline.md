# SolidityDefend v2.0.1 Baseline (v16)

**Date:** 2026-02-13
**Version:** v2.0.1
**Detectors:** 81 (all active, 0 disabled)
**Precision:** 18.4%
**Recall:** 100% (77/77 TPs)
**Total Findings:** 418
**False Positives:** 341

## Changes from v15 (v1.10.23)

Re-enabled 3 detectors that were disabled in v2.0.0 due to excessive false positives:

| Detector | v2.0.0 FPs | v2.0.1 FPs | Reduction |
|----------|-----------|-----------|-----------|
| `oracle-single-source` | 145 | 0 | -100% |
| `l2-block-number-assumption` | 30 | 0 | -100% |
| `l2-push0-cross-deploy` | 40 | 0 | -100% |
| **Total** | **215** | **0** | **-100%** |

## Fix Strategies

### oracle-single-source
- Added Chainlink-specific infrastructure gate (requires `AggregatorV3Interface`, `latestrounddata`, etc.)
- Integrated Safe Patterns Library (`has_multi_oracle_validation`, `is_safe_oracle_consumer`, `has_twap_oracle`)
- View/pure function filtering (no exploit path in read-only context)
- Expanded fallback indicator recognition
- Function declaration skip (avoids matching function names as oracle calls)

### l2-block-number-assumption
- L2 context gate: requires L2-specific interfaces (`IArbSys`, `L1Block`, `ArbGasInfo`) or `block.chainid` with L2 chain names
- Governance snapshot whitelist (snapshot, proposal, vote, governance, propose, queue, execute, delegate, castvote)
- Simple assignment skip (`lastBlock = block.number` without arithmetic)
- Defensive zero-check skip (`block.number == 0`, `!= 0`, `> 0`)
- Governance contract name exclusion

### l2-push0-cross-deploy
- Comment stripping via `clean_source_for_search()` before keyword matching
- Requires `block.chainid` for all cross-chain evidence
- Per-contract body extraction for multi-contract files
- Removed overly broad keywords (`blast`, `scroll`, `base chain`, `create2`)
- Added bridge evidence patterns (`supportedchains`, `destchain`, `targetchain`)
- EVM version override check (`evm_version = "paris"`)
- Governance and vulnerability demonstration contract name exclusion

## Validation Output

```
FILES ANALYZED: 117 (failed: 0)

OVERALL METRICS
  True Positives:    77 / 77 (100.0%)
  False Negatives:    0 / 77 (0.0%)
  False Positives:  341 / 418 (81.6%)

  Precision: 18.4%
  Recall:    100.0%
  F1 Score:  0.311
```
