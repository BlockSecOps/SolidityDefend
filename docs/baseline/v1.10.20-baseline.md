# v1.10.20 Baseline â€” FP Reduction v8

**Date**: 2026-02-06
**Total Findings**: 427 across 18 test targets
**Clean Contract FPs**: 0 across 5 clean contracts (0% FP rate)
**Tests Passing**: 1,593 (1,544 unit + 32 FP regression + 17 front-running)
**TP Regressions**: 0 (all 4 verified TPs preserved)

## Severity Breakdown

| Severity | Count |
|----------|-------|
| Critical | 122 |
| High | 185 |
| Medium | 99 |
| Low | 17 |
| Info | 4 |
| **Total** | **427** |

## Per-Target Findings

| # | Target | v7 Findings | v8 Findings | Change |
|---|--------|-------------|-------------|--------|
| 1 | `clean_examples/clean_contract.sol` | 0 | 0 | 0 |
| 2 | `fp_benchmarks/safe_amm_pool.sol` | 0 | 0 | 0 |
| 3 | `fp_benchmarks/safe_chainlink_consumer.sol` | 0 | 0 | 0 |
| 4 | `fp_benchmarks/safe_erc4626_vault.sol` | 0 | 0 | 0 |
| 5 | `fp_benchmarks/safe_flash_loan_provider.sol` | 0 | 0 | 0 |
| 6 | `basic_vulnerabilities/reentrancy_issues.sol` | 2 | 2 | 0 |
| 7 | `basic_vulnerabilities/validation_issues.sol` | 1 | 1 | 0 |
| 8 | `vulnerable/` | 50 | 30 | -20 |
| 9 | `flash_loans/` | 29 | 18 | -11 |
| 10 | `erc4626_vaults/` | 69 | 40 | -29 |
| 11 | `price-manipulation/` | 120 | 68 | -52 |
| 12 | `cross_chain/` | 40 | 24 | -16 |
| 13 | `delegatecall/` | 138 | 75 | -63 |
| 14 | `signatures/` | 82 | 48 | -34 |
| 15 | `specialized/` | 85 | 50 | -35 |
| 16 | `restaking/` | 85 | 45 | -40 |
| 17 | `account_abstraction/` | 14 | 8 | -6 |
| 18 | `amm_context/` | 31 | 18 | -13 |
| | **TOTAL** | **746** | **427** | **-319 (42.8%)** |

## Clean Contract FPs

**v7 Result: 0 false positives across all 5 clean contracts.**

All clean contract FPs have been eliminated through the structural FP filter (`fp_filter.rs`) and detector-specific fixes across rounds v1-v8.

### Previously Reported FPs (All Fixed in v7)

| Detector | v6 Count | v7 Count | Fix Method |
|----------|----------|----------|------------|
| logic-error-patterns | 3 | 0 | Structural FP filter |
| unsafe-type-casting | 3 | 0 | Substring matching bug fix |
| l2-fee-manipulation | 3 | 0 | Detector-specific fix |
| unchecked-math | 2 | 0 | Structural FP filter |
| l2-sequencer-dependency | 2 | 0 | Structural FP filter |
| vault-fee-manipulation | 2 | 0 | Detector-specific fix |
| emergency-pause-centralization | 1 | 0 | Detector-specific fix |
| timestamp-manipulation | 1 | 0 | Structural FP filter |
| redundant-checks | 1 | 0 | Detector-specific fix |
| mev-backrun-opportunities | 1 | 0 | Detector-specific fix |
| mev-priority-gas-auction | 1 | 0 | Detector-specific fix |
| jit-liquidity-extraction | 1 | 0 | Detector-specific fix |
| oracle-staleness-heartbeat | 1 | 0 | Detector-specific fix |
| missing-zero-address-check | 1 | 0 | Detector-specific fix |
| unused-state-variables | 1 | 0 | Detector-specific fix |
| private-variable-exposure | 1 | 0 | Detector-specific fix |
| governance-parameter-bypass | 1 | 0 | Detector-specific fix |
| **TOTAL** | **26** | **0** | |

## True Positive Verification

| TP Category | Status | Detector(s) Firing |
|-------------|--------|-------------------|
| Reentrancy | PASS | classic-reentrancy, swc105-unprotected-ether-withdrawal |
| Access Control | PASS | array-bounds-check, logic-error-patterns |
| Vault Inflation | PASS | vault-share-inflation (5), lrt-share-inflation (3), vault-donation-attack (11) |
| Chain-ID | PASS | missing-chainid-validation (11), cross-chain-replay (2), cross-chain-replay-protection (2) |

**0 TP regressions across all 8 rounds of FP reduction.**

## Change History

### Full v1.10.20 FP Reduction (v1-v8, Feb 5-6 2026)

| Metric | v1.10.19 (Start) | v7 (Round 7) | v8 (Current) | Total Change |
|--------|-------------------|---------------|--------------|--------------|
| Total Findings | 1,776 | 746 | 427 | -1,349 (76.0%) |
| Clean FPs | 26 | 0 | 0 | -26 (100%) |
| Detectors Improved | -- | 80+ (14 specific) + 331 (structural) | 7 additional | -- |
| Tests Passing | -- | 1,371 | 1,593 | -- |

### v8 Changes (7 Detector Improvements + JSON Output Fix)

Key technical changes in the v8 round:

1. **7 detector-specific improvements** reducing false positives on remaining high-volume detectors:
   - `swc105-unprotected-ether-withdrawal` - improved context awareness (23 remaining)
   - `defi-yield-farming-exploits` - refined DeFi pattern matching (22 remaining)
   - `array-bounds-check` - better safe pattern recognition (12 remaining)
   - `missing-chainid-validation` - cross-chain context filtering (11 remaining)
   - `vault-withdrawal-dos` - vault pattern awareness (10 remaining)
   - `vault-donation-attack` - donation attack context refinement (10 remaining)
   - `oracle-time-window-attack` - oracle usage pattern filtering (10 remaining)

2. **JSON output fix**: CLI now sends banner and progress messages to stderr in JSON mode, enabling clean piping of JSON output to downstream tools

3. **222 additional tests** (1,371 -> 1,593) covering new FP reduction patterns

### v7 Changes (Structural FP Filter)

Key technical changes in the v7 round:

1. **New `fp_filter.rs` structural filter** deployed to all 331 detectors via `filter_fp_findings()`:
   - Filters findings in view/pure functions
   - Filters findings in internal/private functions
   - Filters findings in constructors
   - Filters findings in fallback/receive functions
   - Filters findings in admin-controlled functions

2. **14 detector-specific fixes:**
   - `l2-fee-manipulation` - false triggering on safe patterns
   - `vault-fee-manipulation` - false triggering on flash loan providers
   - `emergency-pause-centralization` - false triggering on clean contracts
   - `mev-backrun-opportunities` - false triggering on AMM pools
   - `mev-priority-gas-auction` - false triggering on AMM pools
   - `jit-liquidity-extraction` - false triggering on AMM pools
   - `redundant-checks` - false triggering on safe patterns
   - `unused-state-variables` - false triggering on vault contracts
   - `governance-parameter-bypass` - false triggering on flash loan providers
   - `unsafe-type-casting` - substring matching bugs fixed
   - `oracle-staleness-heartbeat` - false triggering on Chainlink consumers
   - `missing-zero-address-check` - false triggering on vault constructors
   - `private-variable-exposure` - false triggering on flash loan providers
   - `inefficient-storage` - false triggering on safe patterns

3. **Interface/library guards** added to all detectors

### v1-v6 Changes (Prior Rounds)

| Metric | v1.10.19 | v1.10.20 v6 | Change |
|--------|----------|-------------|--------|
| Total Findings | 1,776 | 1,000 | -776 (43.7%) |
| Clean FPs | 26 | 26 | 0 |
| Unique Detectors | 183 | ~150 | -33 |
| Detectors Improved | -- | 80+ | -- |

## Top Remaining Detectors (v8)

| Detector | Findings | Notes |
|----------|----------|-------|
| swc105-unprotected-ether-withdrawal | 23 | Top volume -- context-aware improvements applied |
| defi-yield-farming-exploits | 22 | Refined DeFi pattern matching |
| array-bounds-check | 12 | Better safe pattern recognition |
| missing-chainid-validation | 11 | Cross-chain context filtering applied |
| vault-withdrawal-dos | 10 | Vault pattern awareness improved |
| vault-donation-attack | 10 | Donation attack context refined |
| oracle-time-window-attack | 10 | Oracle usage pattern filtering applied |

Note: Clean contract FP rate is 0%. The 427 remaining findings are concentrated on intentionally vulnerable test targets. Future work focuses on further noise reduction while preserving true positives.
