{
  "version": "1.0.0",
  "description": "Ground truth dataset for SolidityDefend detector validation",
  "last_updated": "2026-01-16",
  "contracts": {
    "tests/contracts/basic_vulnerabilities/access_control_issues.sol": {
      "contract_name": "AccessControlIssues",
      "expected_findings": [
        {
          "detector_id": "missing-access-modifiers",
          "line_range": [18, 20],
          "label": "true_positive",
          "severity": "critical",
          "description": "Missing access control - setOwner() has no access control",
          "vulnerability_type": "missing-access-control"
        }
      ],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [40, 42],
          "description": "emergencyStop() is properly protected with onlyOwner modifier"
        }
      ]
    },
    "tests/contracts/basic_vulnerabilities/reentrancy_issues.sol": {
      "contract_name": "ReentrancyIssues",
      "expected_findings": [
        {
          "detector_id": "classic-reentrancy",
          "line_range": [28, 34],
          "label": "true_positive",
          "severity": "high",
          "description": "Classic reentrancy in withdrawBasedOnBalance() - state changes after external calls",
          "vulnerability_type": "classic-reentrancy"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/basic_vulnerabilities/validation_issues.sol": {
      "contract_name": "ValidationIssues",
      "expected_findings": [
        {
          "detector_id": "missing-zero-address-check",
          "line_range": [1, 50],
          "label": "true_positive",
          "severity": "medium",
          "description": "Missing zero address check",
          "vulnerability_type": "missing-zero-check"
        },
        {
          "detector_id": "array-bounds-check",
          "line_range": [1, 50],
          "label": "true_positive",
          "severity": "high",
          "description": "Array bounds issue",
          "vulnerability_type": "array-bounds"
        },
        {
          "detector_id": "enhanced-input-validation",
          "line_range": [1, 50],
          "label": "true_positive",
          "severity": "high",
          "description": "Input validation issues",
          "vulnerability_type": "input-validation"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/clean_examples/clean_contract.sol": {
      "contract_name": "CleanContract",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 100],
          "description": "Entire contract implements security best practices"
        }
      ],
      "notes": "This is a secure contract - any findings are false positives"
    },
    "tests/contracts/account_abstraction/vulnerable/VulnerablePaymaster.sol": {
      "contract_name": "VulnerablePaymaster",
      "expected_findings": [
        {
          "detector_id": "erc4337-paymaster-abuse",
          "line_range": [1, 100],
          "label": "true_positive",
          "severity": "critical",
          "description": "ERC-4337 Paymaster abuse vulnerability",
          "vulnerability_type": "aa-paymaster-abuse"
        },
        {
          "detector_id": "aa-paymaster-fund-drain",
          "line_range": [1, 100],
          "label": "true_positive",
          "severity": "critical",
          "description": "Paymaster fund drain vulnerability",
          "vulnerability_type": "aa-fund-drain"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/account_abstraction/secure/SecurePaymaster.sol": {
      "contract_name": "SecurePaymaster",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 200],
          "description": "Implements proper AA security patterns"
        }
      ],
      "notes": "Secure implementation - any findings are false positives"
    },
    "tests/contracts/flash_loans/vulnerable/VulnerableFlashLoan.sol": {
      "contract_name": "VulnerableOracleFlashLoan",
      "expected_findings": [
        {
          "detector_id": "flash-loan-price-manipulation-advanced",
          "line_range": [1, 100],
          "label": "true_positive",
          "severity": "critical",
          "description": "Flash loan price manipulation vulnerability",
          "vulnerability_type": "flash-loan-manipulation"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/flash_loans/secure/SecureFlashLoan.sol": {
      "contract_name": "SecureOracleFlashLoan",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 200],
          "description": "Uses TWAP oracle with multiple sources and deviation checks"
        }
      ],
      "notes": "Secure flash loan resistant implementation"
    },
    "tests/contracts/erc4626_vaults/VulnerableVault_Inflation.sol": {
      "contract_name": "VulnerableVault_Inflation",
      "expected_findings": [
        {
          "detector_id": "vault-share-inflation",
          "line_range": [1, 150],
          "label": "true_positive",
          "severity": "critical",
          "description": "Share inflation attack vulnerability",
          "vulnerability_type": "share-inflation"
        },
        {
          "detector_id": "vault-donation-attack",
          "line_range": [1, 150],
          "label": "true_positive",
          "severity": "high",
          "description": "Donation attack vulnerability",
          "vulnerability_type": "donation-attack"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/erc4626_vaults/SecureVault_VirtualShares.sol": {
      "contract_name": "SecureVault_VirtualShares",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 100],
          "description": "Uses virtual shares offset to prevent inflation attacks"
        }
      ],
      "notes": "Secure vault implementation"
    },
    "tests/contracts/cross_chain/phase13_legacy/bridge_chain_id/vulnerable_simple.sol": {
      "contract_name": "VulnerableBridge",
      "expected_findings": [
        {
          "detector_id": "missing-chainid-validation",
          "line_range": [13, 22],
          "label": "true_positive",
          "severity": "critical",
          "description": "Missing chain ID validation - processMessage() doesn't validate destination chain",
          "vulnerability_type": "missing-chain-validation"
        },
        {
          "detector_id": "missing-chainid-validation",
          "line_range": [26, 37],
          "label": "true_positive",
          "severity": "critical",
          "description": "No chain check - receiveMessage() executes without chain validation",
          "vulnerability_type": "missing-chain-check"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/cross_chain/phase13_legacy/bridge_chain_id/clean.sol": {
      "contract_name": "SecureBridge",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 100],
          "description": "Proper chain ID validation implemented"
        }
      ]
    },
    "tests/contracts/delegatecall/vulnerable/UserControlledDelegatecall.sol": {
      "contract_name": "UserControlledDelegatecall",
      "expected_findings": [
        {
          "detector_id": "dangerous-delegatecall",
          "line_range": [1, 50],
          "label": "true_positive",
          "severity": "critical",
          "description": "User-controlled delegatecall target allows arbitrary code execution",
          "vulnerability_type": "user-controlled-delegatecall"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/delegatecall/secure/SecureDelegatecall.sol": {
      "contract_name": "SecureDelegatecall",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 100],
          "description": "Uses immutable library address for delegatecall"
        }
      ]
    },
    "tests/contracts/delegatecall/vulnerable/ProxyStorageCollision.sol": {
      "contract_name": "ProxyStorageCollision",
      "expected_findings": [
        {
          "detector_id": "proxy-storage-collision",
          "line_range": [1, 50],
          "label": "true_positive",
          "severity": "high",
          "description": "Storage collision between proxy and implementation contracts",
          "vulnerability_type": "storage-collision"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/delegatecall/secure/EIP1967CompliantProxy.sol": {
      "contract_name": "EIP1967CompliantProxy",
      "expected_findings": [],
      "known_false_positives": [],
      "clean_sections": [
        {
          "line_range": [1, 100],
          "description": "Uses EIP-1967 storage slots to prevent collision"
        }
      ]
    },
    "tests/contracts/complex_scenarios/2025_vulnerabilities/defi/FlashLoanArbitrage.sol": {
      "contract_name": "FlashLoanArbitrage",
      "expected_findings": [
        {
          "detector_id": "mev-extractable-value",
          "line_range": [1, 300],
          "label": "true_positive",
          "severity": "high",
          "description": "No MEV protection - susceptible to frontrunning",
          "vulnerability_type": "mev-vulnerability"
        },
        {
          "detector_id": "missing-slippage-protection",
          "line_range": [1, 300],
          "label": "true_positive",
          "severity": "critical",
          "description": "Zero slippage protection vulnerability",
          "vulnerability_type": "no-slippage-protection"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    },
    "tests/contracts/complex_scenarios/2025_vulnerabilities/governance/DAOGovernance.sol": {
      "contract_name": "DAOGovernance",
      "expected_findings": [
        {
          "detector_id": "flash-loan-governance-attack",
          "line_range": [1, 400],
          "label": "true_positive",
          "severity": "critical",
          "description": "Flash loan governance attack vulnerability",
          "vulnerability_type": "flashloan-governance"
        },
        {
          "detector_id": "delegation-loop",
          "line_range": [1, 400],
          "label": "true_positive",
          "severity": "critical",
          "description": "Delegation loop vulnerability",
          "vulnerability_type": "delegation-loop"
        },
        {
          "detector_id": "centralization-risk",
          "line_range": [1, 400],
          "label": "true_positive",
          "severity": "high",
          "description": "Centralization risk",
          "vulnerability_type": "centralization-risk"
        }
      ],
      "known_false_positives": [],
      "clean_sections": []
    }
  },
  "metadata": {
    "total_contracts": 17,
    "total_expected_findings": 19,
    "last_recall": "100.0%",
    "categories": {
      "access_control": 1,
      "reentrancy": 1,
      "validation": 3,
      "account_abstraction": 2,
      "flash_loan": 2,
      "vault_security": 2,
      "cross_chain": 2,
      "delegatecall": 2,
      "governance": 3,
      "mev": 1
    }
  }
}
