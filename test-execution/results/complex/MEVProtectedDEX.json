{
  "version": "1.3.6",
  "timestamp": "2025-11-17T22:55:14.549339Z",
  "findings": [
    {
      "detector_id": "inefficient-storage",
      "message": "Inefficient storage pattern detected. Struct contains mixed uint256 and smaller types. Pack smaller types together for gas savings Inefficient storage layout increases gas costs for all state-modifying operations.",
      "severity": "low",
      "location": {
        "line": 41,
        "column": 0,
        "length": 30
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize storage layout. Consider: (1) Pack variables <32 bytes together in structs, (2) Order struct fields by size (largest to smallest), (3) Use uint256 instead of smaller types for standalone variables, (4) Combine boolean flags into a single uint256 bitmap, (5) Use constants/immutables for unchanging values.",
        "replacements": []
      }
    },
    {
      "detector_id": "inefficient-storage",
      "message": "Inefficient storage pattern detected. Struct contains mixed uint256 and smaller types. Pack smaller types together for gas savings Inefficient storage layout increases gas costs for all state-modifying operations.",
      "severity": "low",
      "location": {
        "line": 51,
        "column": 0,
        "length": 30
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize storage layout. Consider: (1) Pack variables <32 bytes together in structs, (2) Order struct fields by size (largest to smallest), (3) Use uint256 instead of smaller types for standalone variables, (4) Combine boolean flags into a single uint256 bitmap, (5) Use constants/immutables for unchanging values.",
        "replacements": []
      }
    },
    {
      "detector_id": "inefficient-storage",
      "message": "Inefficient storage pattern detected. Struct contains mixed uint256 and smaller types. Pack smaller types together for gas savings Inefficient storage layout increases gas costs for all state-modifying operations.",
      "severity": "low",
      "location": {
        "line": 69,
        "column": 0,
        "length": 30
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize storage layout. Consider: (1) Pack variables <32 bytes together in structs, (2) Order struct fields by size (largest to smallest), (3) Use uint256 instead of smaller types for standalone variables, (4) Combine boolean flags into a single uint256 bitmap, (5) Use constants/immutables for unchanging values.",
        "replacements": []
      }
    },
    {
      "detector_id": "time-locked-admin-bypass",
      "message": "Timelock implementation incomplete - missing queue/schedule or execute functions",
      "severity": "critical",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Implement complete timelock flow: propose→queue→wait(delay)→execute",
        "replacements": []
      }
    },
    {
      "detector_id": "time-locked-admin-bypass",
      "message": "Emergency functions bypass timelock without multisig protection",
      "severity": "critical",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Require multisig approval for emergency functions that bypass timelock",
        "replacements": []
      }
    },
    {
      "detector_id": "guardian-role-centralization",
      "message": "Guardian role lacks explicit revocation mechanism - may be irremovable if compromised",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Implement guardian revocation function callable by DAO/owner for emergency scenarios",
        "replacements": []
      }
    },
    {
      "detector_id": "aa-signature-aggregation-bypass",
      "message": "Aggregated operations lack unique IDs - signature reuse across operations possible",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Generate unique operation ID for each UserOp: keccak256(abi.encode(userOp, nonce, chainId))",
        "replacements": []
      }
    },
    {
      "detector_id": "erc20-transfer-return-bomb",
      "message": "Token transfer lacks return data size validation - vulnerable to return bomb DOS",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Check returndatasize() and reject if excessive (>64 bytes): require(returndatasize() <= 64)",
        "replacements": []
      }
    },
    {
      "detector_id": "token-decimal-confusion",
      "message": "Hardcoded decimal assumption (18) - incompatible with USDC (6), WBTC (8), etc.",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Call token.decimals() and normalize: uint256 decimals = token.decimals(); amount * 10**decimals",
        "replacements": []
      }
    },
    {
      "detector_id": "token-decimal-confusion",
      "message": "Token price/exchange calculation without decimal normalization - incorrect conversions",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Normalize decimals: amount * 10**token1.decimals() / 10**token2.decimals()",
        "replacements": []
      }
    },
    {
      "detector_id": "token-decimal-confusion",
      "message": "Multiple tokens (5) without decimal tracking - calculation errors likely",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Store decimals per token: mapping(address => uint8) public tokenDecimals",
        "replacements": []
      }
    },
    {
      "detector_id": "token-decimal-confusion",
      "message": "Decimal-sensitive math operations without validation - verify decimal assumptions",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Validate expected decimals: require(token.decimals() == EXPECTED_DECIMALS)",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-priority-gas-auction",
      "message": "Public arbitrage function - creates PGA as bots compete for profit",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Capture MEV for protocol via auction mechanism or restrict to specific keepers",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-toxic-flow-exposure",
      "message": "Static fees on AMM - no protection against toxic flow from informed traders",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Implement dynamic fees that increase with volatility or trade size to discourage toxic flow",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-toxic-flow-exposure",
      "message": "No JIT liquidity protection - attackers can add liquidity, extract fees, and withdraw immediately",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Add minimum holding period for LP tokens: mapping(address => uint256) public depositTime",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'transfer' violates constant product invariant: Token transfers don't account for fee-on-transfer tokens, incorrect reserve calculations may result in pool drainage",
      "severity": "critical",
      "location": {
        "line": 8,
        "column": 14,
        "length": 8
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'transfer': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.20;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 24
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.20;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    },
    {
      "detector_id": "eip7702-storage-collision",
      "message": "EIP-7702 delegate uses storage - verify no collision with EOA state",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Use EIP-7201 namespaced storage to avoid collisions:\n\nbytes32 private constant STORAGE_LOCATION = \nkeccak256(\"myprotocol.delegate.storage\");\n\nstruct DelegateStorage {\naddress owner;\nmapping(address => uint256) balances;\n}\n\nfunction _getStorage() private pure returns (DelegateStorage storage $) {\nassembly { $.slot := STORAGE_LOCATION }\n}",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 32,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 104,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 105,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 273,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 442,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 455,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "private-variable-exposure",
      "message": "Sensitive data 'private' in 'private' variable - all blockchain storage is publicly readable",
      "severity": "high",
      "location": {
        "line": 459,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "CRITICAL: 'private' visibility does NOT encrypt data!\n\nAll blockchain storage is publicly readable via:\n- eth_getStorageAt RPC call\n- Block explorers\n- Archive nodes\n\n❌ This is INSECURE:\nstring private password = \"mysecret123\";\n\n✅ Correct approaches:\n\n1. NEVER store secrets on-chain\n2. Store hashes instead:\nbytes32 public passwordHash = keccak256(\"password\");\n\n3. Use commit-reveal for sensitive values:\nbytes32 public commitment = keccak256(abi.encode(value, salt));\n\n4. For truly private data, use off-chain storage or ZK proofs",
        "replacements": []
      }
    },
    {
      "detector_id": "logic-error-patterns",
      "message": "Potential division before multiplication - causes precision loss (OWASP 2025)",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "❌ PRECISION LOSS ($63.8M in losses):\nuint256 reward = (amount / totalSupply) * rewardRate;\n// Result: 0 if amount < totalSupply!\n\n✅ CORRECT ORDER:\nuint256 reward = (amount * rewardRate) / totalSupply;\n// Maximizes precision, multiply before divide\n\n✅ BEST: Use fixed-point math:\nuint256 reward = (amount * rewardRate * 1e18) / totalSupply / 1e18;\n\nReal incidents:\n- Cork Protocol: $11M (May 2025) - Division rounding\n- SIR.trading: $355K (March 2025) - Reward calculation\n- Multiple 2024 incidents: $63.8M total",
        "replacements": []
      }
    },
    {
      "detector_id": "logic-error-patterns",
      "message": "Percentage calculation - verify order of operations for precision",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Percentage calculations require careful ordering:\n\n❌ WRONG (precision loss):\nuint256 fee = (amount / 10000) * feePercent;\n\n✅ CORRECT:\nuint256 fee = (amount * feePercent) / 10000;\n\n✅ BEST (with basis points):\nuint256 constant BASIS_POINTS = 10000;\nuint256 fee = (amount * feeBasisPoints) / BASIS_POINTS;\n\nExample: 250 basis points = 2.5%\namount = 1000, feeBasisPoints = 250\nfee = (1000 * 250) / 10000 = 25 ✅\n\nWRONG order:\nfee = (1000 / 10000) * 250 = 0 * 250 = 0 ❌",
        "replacements": []
      }
    },
    {
      "detector_id": "oracle-staleness-heartbeat",
      "message": "Chainlink oracle without heartbeat configuration - define max price age",
      "severity": "low",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Each Chainlink feed has a specific heartbeat interval.\nDefine these constants based on the feed:\n\nCommon Chainlink heartbeats:\n- ETH/USD: 1 hour (3600 seconds)\n- BTC/USD: 1 hour (3600 seconds)\n- Stable pairs: 24 hours (86400 seconds)\n- Volatile pairs: 1 hour or less\n\n✅ Define heartbeat constants:\nuint256 private constant ETH_USD_HEARTBEAT = 3600;\nuint256 private constant BTC_USD_HEARTBEAT = 3600;\nuint256 private constant USDC_USD_HEARTBEAT = 86400;\nuint256 private constant STALENESS_BUFFER = 300;  // 5 min\n\nfunction validatePrice(\nuint256 updatedAt,\nuint256 heartbeat\n) internal view {\nrequire(\nblock.timestamp - updatedAt <= heartbeat + STALENESS_BUFFER,\n\"Price too stale\"\n);\n}\n\nCheck feed documentation: https://data.chain.link/",
        "replacements": []
      }
    },
    {
      "detector_id": "oracle-staleness-heartbeat",
      "message": "Incomplete Chainlink validation - missing round or price checks",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Complete Chainlink validation checklist:\n\n✅ All required checks:\n(uint80 roundId, int256 price,, uint256 updatedAt, uint80 answeredInRound) = \npriceFeed.latestRoundData();\n\n// Check 1: Price is valid (non-zero)\nrequire(price > 0, \"Invalid price\");\n\n// Check 2: Round is complete (answered)\nrequire(answeredInRound >= roundId, \"Stale round\");\n\n// Check 3: Price is not stale (within heartbeat)\nrequire(\nblock.timestamp - updatedAt <= HEARTBEAT + BUFFER,\n\"Stale price\"\n);\n\n// Check 4: No oracle circuit breaker (optional)\nuint256 minPrice = 1000e8;  // Min expected price\nuint256 maxPrice = 10000e8; // Max expected price\nrequire(price >= int256(minPrice) && price <= int256(maxPrice), \"Price out of bounds\");\n\nWhy each check matters:\n- price > 0: Prevents using zero/negative prices\n- answeredInRound: Ensures round is finalized\n- updatedAt: Prevents stale data usage\n- Circuit breaker: Catches oracle failures",
        "replacements": []
      }
    },
    {
      "detector_id": "enhanced-input-validation",
      "message": "Transfer function without zero-value check - validate non-zero amounts",
      "severity": "medium",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "❌ MISSING ZERO-VALUE CHECK:\nfunction transfer(address to, uint256 amount) external {\n_transfer(msg.sender, to, amount);\n// What if amount is 0? Wastes gas, may break accounting\n}\n\n✅ VALIDATE NON-ZERO:\nfunction transfer(address to, uint256 amount) external {\nrequire(amount > 0, \"Zero amount\");\nrequire(to != address(0), \"Zero address\");\n_transfer(msg.sender, to, amount);\n}\n\n✅ COMPLETE VALIDATION:\nfunction deposit(uint256 amount) external payable {\n// For ERC20 deposits\nrequire(amount > 0, \"Zero amount\");\nrequire(amount <= MAX_DEPOSIT, \"Exceeds maximum\");\n\n// For native ETH deposits\nif (msg.value > 0) {\nrequire(msg.value == amount, \"Value mismatch\");\n}\n\n// Proceed with deposit\n}",
        "replacements": []
      }
    },
    {
      "detector_id": "post-080-overflow",
      "message": "Type casting to smaller uint - verify no overflow on downcast",
      "severity": "low",
      "location": {
        "line": 1,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Downcasting can silently overflow even in Solidity 0.8.0+!\n\n❌ UNSAFE DOWNCAST:\nuint256 bigValue = 1000;\nuint8 smallValue = uint8(bigValue);  // Wraps to 232! (1000 % 256)\n\n✅ SAFE DOWNCAST with validation:\nuint256 bigValue = 1000;\nrequire(bigValue <= type(uint8).max, \"Value too large\");\nuint8 smallValue = uint8(bigValue);  // Safe now\n\n✅ USE SafeCast library (OpenZeppelin):\nimport \"@openzeppelin/contracts/utils/math/SafeCast.sol\";\n\nuint256 bigValue = 1000;\nuint8 smallValue = SafeCast.toUint8(bigValue);  // Reverts if > 255\n\nType limits:\n- uint8:   0 to 255\n- uint16:  0 to 65,535\n- uint32:  0 to 4,294,967,295\n- uint64:  0 to 18,446,744,073,709,551,615\n- uint256: 0 to 2^256-1",
        "replacements": []
      }
    },
    {
      "detector_id": "jit-liquidity-sandwich",
      "message": "Liquidity becomes active immediately - may enable JIT sandwich attacks",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Consider delaying liquidity activation to the next epoch or block to mitigate JIT attacks",
        "replacements": []
      }
    },
    {
      "detector_id": "pool-donation-enhanced",
      "message": "Pool initialization lacks protection - first depositor can manipulate initial share price",
      "severity": "high",
      "location": {
        "line": 1,
        "column": 1,
        "length": 15198
      },
      "fix_suggestion": {
        "description": "Require minimum initial deposit, mint dead shares on initialization, or use time-delayed activation",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-access-modifiers",
      "message": "Function 'startBatchAuction' performs critical operations but lacks access control modifiers",
      "severity": "critical",
      "location": {
        "line": 253,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier like 'onlyOwner' to function 'startBatchAuction'",
        "replacements": []
      }
    },
    {
      "detector_id": "readonly-reentrancy",
      "message": "View function 'calculateAmountOut' reads state that may be inconsistent during reentrancy. Contract has state-changing functions that make external calls before updating state.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Add a reentrancy guard to state-changing functions or ensure view function 'calculateAmountOut' cannot be called during callbacks (e.g., using a reentrancy lock check in the view function)",
        "replacements": []
      }
    },
    {
      "detector_id": "readonly-reentrancy",
      "message": "View function 'getOraclePrice' reads state that may be inconsistent during reentrancy. Contract has state-changing functions that make external calls before updating state.",
      "severity": "medium",
      "location": {
        "line": 342,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Add a reentrancy guard to state-changing functions or ensure view function 'getOraclePrice' cannot be called during callbacks (e.g., using a reentrancy lock check in the view function)",
        "replacements": []
      }
    },
    {
      "detector_id": "readonly-reentrancy",
      "message": "View function 'getCurrentPrice' reads state that may be inconsistent during reentrancy. Contract has state-changing functions that make external calls before updating state.",
      "severity": "medium",
      "location": {
        "line": 359,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Add a reentrancy guard to state-changing functions or ensure view function 'getCurrentPrice' cannot be called during callbacks (e.g., using a reentrancy lock check in the view function)",
        "replacements": []
      }
    },
    {
      "detector_id": "invalid-state-transition",
      "message": "State variables modified after external call - potential reentrancy affecting state machine",
      "severity": "critical",
      "location": {
        "line": 300,
        "column": 9,
        "length": 54
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Use checks-effects-interactions pattern or reentrancy guards",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'tokenB' in function 'createPool' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 139,
        "column": 17,
        "length": 6
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(tokenB != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'oracleA' in function 'createPool' is not checked for zero address",
      "severity": "medium",
      "location": {
        "line": 140,
        "column": 17,
        "length": 7
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(oracleA != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'oracleB' in function 'createPool' is not checked for zero address",
      "severity": "medium",
      "location": {
        "line": 141,
        "column": 17,
        "length": 7
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(oracleB != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'tokenIn' in function 'revealOrder' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 200,
        "column": 17,
        "length": 7
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(tokenIn != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'tokenOut' in function 'revealOrder' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 201,
        "column": 17,
        "length": 8
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(tokenOut != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "single-oracle-source",
      "message": "Function 'createPool' relies on a single oracle source, creating centralization risk",
      "severity": "high",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-693",
      "fix_suggestion": {
        "description": "Use multiple oracle sources and implement price aggregation in function 'createPool'",
        "replacements": []
      }
    },
    {
      "detector_id": "unchecked-external-call",
      "message": "External call in function 'createPool' does not check return value",
      "severity": "medium",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-252",
      "fix_suggestion": {
        "description": "Check the return value of external calls in function 'createPool'",
        "replacements": []
      }
    },
    {
      "detector_id": "unchecked-external-call",
      "message": "External call in function '_executeOrder' does not check return value",
      "severity": "medium",
      "location": {
        "line": 273,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-252",
      "fix_suggestion": {
        "description": "Check the return value of external calls in function '_executeOrder'",
        "replacements": []
      }
    },
    {
      "detector_id": "auction-timing-manipulation",
      "message": "Function 'startBatchAuction' allows auction creation with predictable timing and unrestricted access. MEV bots can monitor the mempool, front-run the auction start, and prepare optimal bids before other participants.",
      "severity": "high",
      "location": {
        "line": 253,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Add access control to auction start in function 'startBatchAuction' and implement unpredictable timing using commit-reveal or VRF. Example: modifier onlyAuctioneer() or use block hash for randomized start time.",
        "replacements": []
      }
    },
    {
      "detector_id": "weak-commit-reveal",
      "message": "Function 'commitOrder' implements commit-reveal scheme with insufficient delay (too short and predictable). MEV bots can monitor commitments and time their reveals to front-run legitimate users.",
      "severity": "medium",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Increase commit-reveal delay in function 'commitOrder' to at least 5 minutes and add randomization. Example: Use VRF for unpredictable reveal windows or implement variable delays based on block hash.",
        "replacements": []
      }
    },
    {
      "detector_id": "weak-commit-reveal",
      "message": "Function 'revealOrder' implements commit-reveal scheme with insufficient delay (too short and predictable). MEV bots can monitor commitments and time their reveals to front-run legitimate users.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Increase commit-reveal delay in function 'revealOrder' to at least 5 minutes and add randomization. Example: Use VRF for unpredictable reveal windows or implement variable delays based on block hash.",
        "replacements": []
      }
    },
    {
      "detector_id": "emergency-function-abuse",
      "message": "Function 'emergencyPause' is an emergency function without time-lock or multi-signature protection. A single admin can execute emergency actions immediately, enabling potential abuse or rug pulls.",
      "severity": "medium",
      "location": {
        "line": 412,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-269",
      "fix_suggestion": {
        "description": "Add time-lock and multi-sig protection to emergency function 'emergencyPause'. Example: Require time-lock delay (e.g., 24-48 hours) and multi-signature approval before emergency actions can be executed.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-price-manipulation",
      "message": "Function 'withinGasLimit' uses tx.gasprice for MEV protection which can be bypassed. Flashbots and private mempools allow MEV bots to execute transactions with any gas price without going through the public mempool.",
      "severity": "medium",
      "location": {
        "line": 118,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-693",
      "fix_suggestion": {
        "description": "Replace gas price checks in function 'withinGasLimit' with robust MEV protection. Example: Use commit-reveal schemes with sufficient delays, implement order batching, or use decentralized sequencers.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-price-manipulation",
      "message": "Function '_executeOrder' uses tx.gasprice for MEV protection which can be bypassed. Flashbots and private mempools allow MEV bots to execute transactions with any gas price without going through the public mempool.",
      "severity": "medium",
      "location": {
        "line": 273,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-693",
      "fix_suggestion": {
        "description": "Replace gas price checks in function '_executeOrder' with robust MEV protection. Example: Use commit-reveal schemes with sufficient delays, implement order batching, or use decentralized sequencers.",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-liquidity-manipulation",
      "message": "Function 'calculateAmountOut' is vulnerable to AMM liquidity manipulation. Price calculation uses current reserves without slippage protection, deadline checks, or minimum output validation Liquidity manipulation can drain pools, enable sandwich attacks, or allow attackers to profit from price manipulation.",
      "severity": "critical",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Protect 'calculateAmountOut' from liquidity manipulation. Implement minimum liquidity locks, use TWAP oracles instead of spot prices, add reentrancy guards, validate reserves before and after trades, and implement trade size limits.",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-liquidity-manipulation",
      "message": "Function 'getCurrentPrice' is vulnerable to AMM liquidity manipulation. Price calculation uses current reserves without slippage protection, deadline checks, or minimum output validation Liquidity manipulation can drain pools, enable sandwich attacks, or allow attackers to profit from price manipulation.",
      "severity": "critical",
      "location": {
        "line": 359,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Protect 'getCurrentPrice' from liquidity manipulation. Implement minimum liquidity locks, use TWAP oracles instead of spot prices, add reentrancy guards, validate reserves before and after trades, and implement trade size limits.",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-liquidity-manipulation",
      "message": "Function 'addLiquidity' is vulnerable to AMM liquidity manipulation. Liquidity operations lack minimum liquidity lock or time-based restrictions, enabling flash loan pool manipulation Liquidity manipulation can drain pools, enable sandwich attacks, or allow attackers to profit from price manipulation.",
      "severity": "critical",
      "location": {
        "line": 378,
        "column": 14,
        "length": 12
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Protect 'addLiquidity' from liquidity manipulation. Implement minimum liquidity locks, use TWAP oracles instead of spot prices, add reentrancy guards, validate reserves before and after trades, and implement trade size limits.",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-fee-manipulation",
      "message": "Function 'calculateAmountOut' may be vulnerable to fee manipulation attack. Unprotected fee update without timelock. Fee changes take effect immediately, enabling front-running attacks Attacker can front-run fee changes to extract value from depositors.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect 'calculateAmountOut' from fee manipulation. Solutions: (1) Implement timelock delay on fee updates (24-48 hours minimum), (2) Emit events before fee changes take effect with advance notice, (3) Add maximum fee change limits per update (e.g., max 2% fee), (4) Require multi-sig approval for fee changes (Gnosis Safe pattern), (5) Use gradual fee ramping instead of instant updates (Curve style), (6) Implement MEV protection patterns for fee-dependent operations, (7) Consider OpenZeppelin TimelockController for governance.",
        "replacements": []
      }
    },
    {
      "detector_id": "sandwich-resistant-swap",
      "message": "Function 'getCurrentPrice' lacks sandwich attack protection. No minimum output amount (amountOutMin) parameter for slippage protection, leaving swap vulnerable to sandwich attacks MEV bots can front-run user swaps, manipulate price, then back-run to profit from the price difference at user's expense.",
      "severity": "high",
      "location": {
        "line": 359,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Add sandwich attack protection to 'getCurrentPrice'. Implement: (1) Slippage tolerance with amountOutMin parameter, (2) Commit-reveal scheme for swap parameters, (3) Private mempool submission, (4) MEV-resistant AMM curve, (5) Batch auctions instead of continuous trading.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'oracleValid' has dangerous timestamp dependency. Performs arithmetic on block.timestamp without overflow protection, potentially manipulable by miners within bounds Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 124,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'oracleValid'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'createPool' has dangerous timestamp dependency. Uses keccak256 with block variables (timestamp/difficulty/number/prevrandao) for randomness. These values are predictable/manipulable by miners and validators, enabling attacks on randomness-dependent logic. Use Chainlink VRF or commit-reveal schemes instead Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'createPool'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'commitOrder' has dangerous timestamp dependency. Performs arithmetic on block.timestamp without overflow protection, potentially manipulable by miners within bounds Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'commitOrder'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'revealOrder' has dangerous timestamp dependency. Uses keccak256 with block variables (timestamp/difficulty/number/prevrandao) for randomness. These values are predictable/manipulable by miners and validators, enabling attacks on randomness-dependent logic. Use Chainlink VRF or commit-reveal schemes instead Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'revealOrder'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'startBatchAuction' has dangerous timestamp dependency. Performs arithmetic on block.timestamp without overflow protection, potentially manipulable by miners within bounds Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 253,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'startBatchAuction'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function '_executeOrder' has dangerous timestamp dependency. Timestamp manipulation vulnerability marker detected Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 273,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in '_executeOrder'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "block-stuffing-vulnerable",
      "message": "Function 'revealOrder' is vulnerable to block stuffing attacks. First-come-first-served mechanism with strict ordering, attackers can stuff blocks to prevent others from participating Attackers can fill blocks with transactions to prevent legitimate users from executing time-sensitive operations.",
      "severity": "high",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Mitigate block stuffing in 'revealOrder'. Implement: (1) Grace periods extending deadlines, (2) Multi-block operation windows, (3) Commit-reveal with extended reveal period, (4) Allow batch processing across multiple blocks, (5) Emergency pause mechanisms.",
        "replacements": []
      }
    },
    {
      "detector_id": "block-stuffing-vulnerable",
      "message": "Function 'startBatchAuction' is vulnerable to block stuffing attacks. Auction closes in single block without multi-block finalization period, vulnerable to block stuffing to prevent last-minute bids Attackers can fill blocks with transactions to prevent legitimate users from executing time-sensitive operations.",
      "severity": "high",
      "location": {
        "line": 253,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Mitigate block stuffing in 'startBatchAuction'. Implement: (1) Grace periods extending deadlines, (2) Multi-block operation windows, (3) Commit-reveal with extended reveal period, (4) Allow batch processing across multiple blocks, (5) Emergency pause mechanisms.",
        "replacements": []
      }
    },
    {
      "detector_id": "block-stuffing-vulnerable",
      "message": "Function '_executeOrder' is vulnerable to block stuffing attacks. First-come-first-served mechanism with strict ordering, attackers can stuff blocks to prevent others from participating Attackers can fill blocks with transactions to prevent legitimate users from executing time-sensitive operations.",
      "severity": "high",
      "location": {
        "line": 273,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Mitigate block stuffing in '_executeOrder'. Implement: (1) Grace periods extending deadlines, (2) Multi-block operation windows, (3) Commit-reveal with extended reveal period, (4) Allow batch processing across multiple blocks, (5) Emergency pause mechanisms.",
        "replacements": []
      }
    },
    {
      "detector_id": "nonce-reuse",
      "message": "Function 'revealOrder' has nonce management vulnerability. Uses global nonce instead of per-user mapping, forces sequential execution and limits parallelization Improper nonce handling enables replay attacks or transaction reordering exploits.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Fix nonce management in 'revealOrder'. Increment nonce after validation, use mapping(address => uint256) for per-user nonces, validate nonce before execution, include nonce in signature hash, and implement nonce cancellation mechanism.",
        "replacements": []
      }
    },
    {
      "detector_id": "token-supply-manipulation",
      "message": "Function 'addLiquidity' has token supply manipulation vulnerability. Mint function lacks maximum supply cap, enables unlimited token minting and hyperinflation Improper supply controls can lead to unlimited minting, hyperinflation, or complete token devaluation.",
      "severity": "critical",
      "location": {
        "line": 378,
        "column": 14,
        "length": 12
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Fix token supply controls in 'addLiquidity'. Implement maximum supply cap, add minting rate limits, require multi-signature for minting, add supply change events, validate burn amounts, and implement supply monitoring.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-griefing",
      "message": "Function '_executeOrder' has gas griefing vulnerability. External call in loop without gas limit, attacker can grief by consuming all gas Attackers can force users to waste gas or cause transactions to fail.",
      "severity": "medium",
      "location": {
        "line": 273,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Mitigate gas griefing in '_executeOrder'. Use pull pattern for transfers, limit array sizes, add gas stipends, implement gas-efficient loops, avoid unbounded operations, use OpenZeppelin SafeERC20.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-griefing",
      "message": "Function 'addLiquidity' has gas griefing vulnerability. Transfer without gas stipend, recipient can grief by consuming gas in fallback Attackers can force users to waste gas or cause transactions to fail.",
      "severity": "medium",
      "location": {
        "line": 378,
        "column": 14,
        "length": 12
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Mitigate gas griefing in 'addLiquidity'. Use pull pattern for transfers, limit array sizes, add gas stipends, implement gas-efficient loops, avoid unbounded operations, use OpenZeppelin SafeERC20.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'sqrt' contains excessive gas usage pattern. Storage write operation inside loop. Consider using memory array Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 442,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'sqrt'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "redundant-checks",
      "message": "Function 'revealOrder' contains redundant checks. 3 consecutive require statements. Consider combining into fewer checks Redundant checks waste gas and increase transaction costs unnecessarily.",
      "severity": "low",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Remove redundant checks in 'revealOrder'. Consider: (1) Eliminate duplicate require() statements, (2) Combine multiple checks into single require(), (3) Remove overflow checks in Solidity >=0.8, (4) Avoid checking same condition in modifier and function, (5) Use custom errors instead of require with strings.",
        "replacements": []
      }
    },
    {
      "detector_id": "price-oracle-stale",
      "message": "Function 'getOraclePrice' uses oracle price data without staleness validation. Oracle price fetch without staleness validation. Missing checks for updatedAt timestamp, price age, or heartbeat threshold Using stale oracle data can lead to incorrect liquidations, price manipulations, and financial losses.",
      "severity": "critical",
      "location": {
        "line": 342,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-829",
      "fix_suggestion": {
        "description": "Add staleness checks in 'getOraclePrice'. Implement: (1) Check oracle updatedAt timestamp, (2) Verify data freshness with block.timestamp comparison, (3) Add HEARTBEAT_THRESHOLD constant (e.g., 3600 seconds), (4) Revert if price is too old, (5) Consider Chainlink's latestRoundData() with timestamp validation.",
        "replacements": []
      }
    },
    {
      "detector_id": "insufficient-randomness",
      "message": "Function 'createPool' uses weak randomness source. Uses block.timestamp for randomness generation. Miners can manipulate timestamp within ~15 second range to influence outcome Predictable randomness enables attackers to manipulate outcomes in lotteries, games, or selection processes.",
      "severity": "high",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-338",
      "fix_suggestion": {
        "description": "Use secure randomness in 'createPool'. Implement: (1) Chainlink VRF for verifiable randomness, (2) Commit-reveal scheme with multi-block delay, (3) External oracle for random number generation, (4) Avoid block.timestamp, blockhash, or block.number, (5) Use Randao for Ethereum 2.0.",
        "replacements": []
      }
    },
    {
      "detector_id": "insufficient-randomness",
      "message": "Function 'revealOrder' uses weak randomness source. Uses block.timestamp for randomness generation. Miners can manipulate timestamp within ~15 second range to influence outcome Predictable randomness enables attackers to manipulate outcomes in lotteries, games, or selection processes.",
      "severity": "high",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-338",
      "fix_suggestion": {
        "description": "Use secure randomness in 'revealOrder'. Implement: (1) Chainlink VRF for verifiable randomness, (2) Commit-reveal scheme with multi-block delay, (3) External oracle for random number generation, (4) Avoid block.timestamp, blockhash, or block.number, (5) Use Randao for Ethereum 2.0.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'withinGasLimit' contains variable shadowing. Parameter 'maxGasPrice' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 118,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'withinGasLimit'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'oracleValid' contains variable shadowing. Parameter 'oracleValidityPeriod' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 124,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'oracleValid'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'createPool' contains variable shadowing. Parameter 'tokenA' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'createPool'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'createPool' contains variable shadowing. Parameter 'tokenB' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'createPool'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'createPool' contains variable shadowing. Local variable 'tokenA' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'createPool'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'createPool' contains variable shadowing. Local variable 'tokenB' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 137,
        "column": 14,
        "length": 10
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'createPool'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'commitOrder' contains variable shadowing. Parameter 'commitment' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'commitOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'commitOrder' contains variable shadowing. Local variable 'revealDeadline' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'commitOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Parameter 'tokenIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Parameter 'tokenOut' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Local variable 'tokenIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Local variable 'tokenOut' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Local variable 'amountIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Local variable 'minAmountOut' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'revealOrder' contains variable shadowing. Local variable 'nonce' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 198,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'revealOrder'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'startBatchAuction' contains variable shadowing. Local variable 'endTime' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 253,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'startBatchAuction'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Parameter 'tokenIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Parameter 'tokenOut' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'tokenIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'tokenOut' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'amountIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'reserveIn' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'reserveOut' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'numerator' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'calculateAmountOut' contains variable shadowing. Local variable 'denominator' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'calculateAmountOut'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'sqrt' contains variable shadowing. Local variable 'x' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 442,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'sqrt'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "unsafe-type-casting",
      "message": "Function 'getOraclePrice' contains unsafe type casting. int to uint conversion without sign check. Negative values will wrap to large positive Unsafe type conversions can lead to data loss, value truncation, or unexpected behavior.",
      "severity": "medium",
      "location": {
        "line": 352,
        "column": 0,
        "length": 20
      },
      "cwe": "CWE-704",
      "fix_suggestion": {
        "description": "Add safe type casting in 'getOraclePrice'. Implement: (1) Validate value ranges before casting, (2) Use require() to check bounds, (3) Use SafeCast library from OpenZeppelin, (4) Avoid downcasting without validation, (5) Check for sign preservation in int/uint conversions.",
        "replacements": []
      }
    },
    {
      "detector_id": "unsafe-type-casting",
      "message": "Function 'getOraclePrice' contains unsafe type casting. uint to int conversion without overflow check. Large values may become negative Unsafe type conversions can lead to data loss, value truncation, or unexpected behavior.",
      "severity": "medium",
      "location": {
        "line": 352,
        "column": 0,
        "length": 20
      },
      "cwe": "CWE-704",
      "fix_suggestion": {
        "description": "Add safe type casting in 'getOraclePrice'. Implement: (1) Validate value ranges before casting, (2) Use require() to check bounds, (3) Use SafeCast library from OpenZeppelin, (4) Avoid downcasting without validation, (5) Check for sign preservation in int/uint conversions.",
        "replacements": []
      }
    },
    {
      "detector_id": "defi-liquidity-pool-manipulation",
      "message": "No ratio validation for liquidity provision in 'addLiquidity'",
      "severity": "medium",
      "location": {
        "line": 378,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Validate ratio: require(amount0 * reserve1 == amount1 * reserve0, \"Invalid ratio\");",
        "replacements": []
      }
    },
    {
      "detector_id": "defi-jit-liquidity-attacks",
      "message": "No cooldown period between add and remove liquidity in 'addLiquidity'",
      "severity": "medium",
      "location": {
        "line": 378,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add cooldown: require(block.timestamp >= lastDeposit[msg.sender] + COOLDOWN_PERIOD, \"Cooldown active\");",
        "replacements": []
      }
    },
    {
      "detector_id": "defi-jit-liquidity-attacks",
      "message": "No entry fee to discourage JIT liquidity provision in 'addLiquidity'",
      "severity": "low",
      "location": {
        "line": 378,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Consider entry fee: Apply small fee on liquidity provision to make JIT attacks unprofitable",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-transaction-deadline",
      "message": "Function 'addLiquidity' is missing transaction deadline. Missing transaction deadline. Time-sensitive operation 'addLiquidity' has no deadline parameter or expiration validation. Transaction can be executed at any time, potentially at unfavorable conditions This allows MEV bots to delay execution for profit, transactions to execute at stale prices, and users to lose funds due to unfavorable timing. Transactions sitting in mempool can be executed when conditions have significantly changed",
      "severity": "medium",
      "location": {
        "line": 378,
        "column": 14,
        "length": 12
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Add deadline to 'addLiquidity'. Implement: (1) Add 'deadline' parameter: function addLiquidity(... uint256 deadline); (2) Validate deadline: require(block.timestamp <= deadline, 'Transaction expired'); (3) For orders: Store expiration and check on execution; (4) Use reasonable deadline in frontend: block.timestamp + 15 minutes; (5) For batch operations: Apply deadline to entire batch; (6) Document deadline behavior for users",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'commitOrder' violates constant product invariant: K invariant check doesn't account for fees, may incorrectly reject valid swaps or allow invalid ones",
      "severity": "critical",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'commitOrder': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function '_executeOrder' violates constant product invariant: Token transfers don't account for fee-on-transfer tokens, incorrect reserve calculations may result in pool drainage",
      "severity": "critical",
      "location": {
        "line": 273,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function '_executeOrder': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'calculateAmountOut' violates constant product invariant: Swap lacks slippage protection (minAmountOut parameter), users vulnerable to sandwich attacks and MEV; K invariant check doesn't account for fees, may incorrectly reject valid swaps or allow invalid ones; AMM K invariant vulnerability marker detected",
      "severity": "critical",
      "location": {
        "line": 311,
        "column": 14,
        "length": 18
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'calculateAmountOut': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'addLiquidity' violates constant product invariant: Token transfers don't account for fee-on-transfer tokens, incorrect reserve calculations may result in pool drainage",
      "severity": "critical",
      "location": {
        "line": 378,
        "column": 14,
        "length": 12
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'addLiquidity': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-data-availability",
      "message": "Function 'updateMEVParameters' submits batches without proper data availability guarantees. No calldata parameter detected. L2 batch data should be published as calldata to ensure L1 data availability Missing data publication can lead to data withholding attacks and prevent users from reconstructing state.",
      "severity": "high",
      "location": {
        "line": 420,
        "column": 14,
        "length": 19
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add data availability to 'updateMEVParameters': (1) Publish transaction data as calldata to L1, (2) Store data commitment hash (keccak256 of batch data) in L1 state, (3) Emit event with data or data hash for availability, (4) Implement data availability challenge mechanism, (5) Use blob transactions (EIP-4844) for cost-efficient DA.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-data-availability",
      "message": "Function 'updateMEVParameters' submits batches without proper data availability guarantees. No data hash commitment to L1. Should store hash of batch data on L1 for verifiability Missing data publication can lead to data withholding attacks and prevent users from reconstructing state.",
      "severity": "high",
      "location": {
        "line": 420,
        "column": 14,
        "length": 19
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add data availability to 'updateMEVParameters': (1) Publish transaction data as calldata to L1, (2) Store data commitment hash (keccak256 of batch data) in L1 state, (3) Emit event with data or data hash for availability, (4) Implement data availability challenge mechanism, (5) Use blob transactions (EIP-4844) for cost-efficient DA.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-data-availability",
      "message": "Function 'updateMEVParameters' submits batches without proper data availability guarantees. Missing event emission. Should emit event with data or data hash for off-chain availability monitoring Missing data publication can lead to data withholding attacks and prevent users from reconstructing state.",
      "severity": "high",
      "location": {
        "line": 420,
        "column": 14,
        "length": 19
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add data availability to 'updateMEVParameters': (1) Publish transaction data as calldata to L1, (2) Store data commitment hash (keccak256 of batch data) in L1 state, (3) Emit event with data or data hash for availability, (4) Implement data availability challenge mechanism, (5) Use blob transactions (EIP-4844) for cost-efficient DA.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-data-availability",
      "message": "Function 'updateMEVParameters' submits batches without proper data availability guarantees. No data availability verification. Should implement mechanism to verify data can be retrieved Missing data publication can lead to data withholding attacks and prevent users from reconstructing state.",
      "severity": "high",
      "location": {
        "line": 420,
        "column": 14,
        "length": 19
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add data availability to 'updateMEVParameters': (1) Publish transaction data as calldata to L1, (2) Store data commitment hash (keccak256 of batch data) in L1 state, (3) Emit event with data or data hash for availability, (4) Implement data availability challenge mechanism, (5) Use blob transactions (EIP-4844) for cost-efficient DA.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'commitOrder' updates fees without proper protections. No access control on fee updates. Anyone can modify fees leading to manipulation Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'commitOrder': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'commitOrder' updates fees without proper protections. No rate limiting on fee updates. Fees could be changed too frequently causing instability Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 172,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'commitOrder': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "erc7821-batch-authorization",
      "message": "Missing authorization in batch executor 'startBatchAuction' - anyone can execute arbitrary calls",
      "severity": "critical",
      "location": {
        "line": 253,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add authorization check:\n\naddress public owner;\n\nfunction executeBatch(\naddress[] calldata targets,\nbytes[] calldata datas\n) external {\nrequire(msg.sender == owner, \"Not authorized\");\n\nfor (uint i = 0; i < targets.length; i++) {\n(bool success,) = targets[i].call(datas[i]);\nrequire(success);\n}\n}",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "1.3.6",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "1.3.6",
    "branding": {
      "name": "BlockSecOps",
      "url": "https://BlockSecOps.com",
      "description": "Enterprise-Grade DevSecOps Platform for Smart Contracts"
    }
  },
  "statistics": {
    "total_findings": 118,
    "severity_counts": {
      "low": 9,
      "medium": 58,
      "info": 0,
      "high": 36,
      "critical": 15
    },
    "unique_detectors": 48
  }
}