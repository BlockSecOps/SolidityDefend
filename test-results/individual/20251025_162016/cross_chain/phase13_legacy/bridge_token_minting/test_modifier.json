Loaded configuration from: .soliditydefend.yml
Starting analysis...
Analyzing: /Users/pwner/Git/ABS/SolidityDefend/tests/contracts/cross_chain/phase13_legacy/bridge_token_minting/test_modifier.sol
  Found 7 issues
{
  "version": "1.0.0",
  "timestamp": "2025-10-25T22:20:19.755015Z",
  "findings": [
    {
      "detector_id": "missing-access-modifiers",
      "message": "Function 'mint' performs critical operations but lacks access control modifiers",
      "severity": "critical",
      "location": {
        "line": 9,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier like 'onlyOwner' to function 'mint'",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'amount' of type 'uint' may need validation",
      "severity": "low",
      "location": {
        "line": 9,
        "column": 27,
        "length": 6
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(amount > 0, \"Amount must be positive\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'amount' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 9,
        "column": 27,
        "length": 6
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'amount' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-liquidity-manipulation",
      "message": "Function 'mint' is vulnerable to AMM liquidity manipulation. Liquidity operations lack minimum liquidity lock or time-based restrictions, enabling flash loan pool manipulation Liquidity manipulation can drain pools, enable sandwich attacks, or allow attackers to profit from price manipulation.",
      "severity": "critical",
      "location": {
        "line": 9,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Protect 'mint' from liquidity manipulation. Implement minimum liquidity locks, use TWAP oracles instead of spot prices, add reentrancy guards, validate reserves before and after trades, and implement trade size limits.",
        "replacements": []
      }
    },
    {
      "detector_id": "token-supply-manipulation",
      "message": "Function 'mint' has token supply manipulation vulnerability. Mint function lacks maximum supply cap, enables unlimited token minting and hyperinflation Improper supply controls can lead to unlimited minting, hyperinflation, or complete token devaluation.",
      "severity": "critical",
      "location": {
        "line": 9,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Fix token supply controls in 'mint'. Implement maximum supply cap, add minting rate limits, require multi-signature for minting, add supply change events, validate burn amounts, and implement supply monitoring.",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-token-mint-control",
      "message": "Missing message validation before minting in 'mint'",
      "severity": "critical",
      "location": {
        "line": 9,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add: require(verifyMessage(hash, proof)); require(!processed[hash]); processed[hash] = true;",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.0;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 23
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.0;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "1.0.0",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "1.0.0"
  },
  "statistics": {
    "total_findings": 7,
    "severity_counts": {
      "critical": 4,
      "info": 0,
      "high": 0,
      "low": 2,
      "medium": 1
    },
    "unique_detectors": 6
  }
}

Analysis complete:
  Files analyzed: 1
  Successful: 1
  Issues found: 7
  Time taken: 0.00s

Exiting with code 1 due to:
  - Found high or critical severity issues
