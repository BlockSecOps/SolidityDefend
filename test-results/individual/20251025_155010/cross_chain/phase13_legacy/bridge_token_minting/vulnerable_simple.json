Loaded configuration from: .soliditydefend.yml
Starting analysis...
Analyzing: /Users/pwner/Git/ABS/SolidityDefend/tests/contracts/cross_chain/phase13_legacy/bridge_token_minting/vulnerable_simple.sol
  Found 19 issues
{
  "version": "1.0.0",
  "timestamp": "2025-10-25T21:50:12.747693Z",
  "findings": [
    {
      "detector_id": "missing-access-modifiers",
      "message": "Function 'mint' performs critical operations but lacks access control modifiers",
      "severity": "critical",
      "location": {
        "line": 16,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier like 'onlyOwner' to function 'mint'",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'to' in function 'mint' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 16,
        "column": 27,
        "length": 2
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(to != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'recipient' in function 'issueTokens' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 24,
        "column": 34,
        "length": 9
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(recipient != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'to' of type 'address' may need validation",
      "severity": "low",
      "location": {
        "line": 16,
        "column": 27,
        "length": 2
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(to != address(0), \"Invalid address\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'amount' of type 'uint' may need validation",
      "severity": "low",
      "location": {
        "line": 16,
        "column": 39,
        "length": 6
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(amount > 0, \"Amount must be positive\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'to' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 16,
        "column": 27,
        "length": 2
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'to' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'amount' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 16,
        "column": 39,
        "length": 6
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'amount' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'recipient' of type 'address' may need validation",
      "severity": "low",
      "location": {
        "line": 24,
        "column": 34,
        "length": 9
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(recipient != address(0), \"Invalid address\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'value' of type 'uint' may need validation",
      "severity": "low",
      "location": {
        "line": 24,
        "column": 53,
        "length": 5
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "Add appropriate range validation for value",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'recipient' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 24,
        "column": 34,
        "length": 9
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'recipient' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'value' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 24,
        "column": 53,
        "length": 5
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'value' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-share-inflation",
      "message": "Function 'mint' is vulnerable to vault share inflation attack. No minimum deposit amount enforced, allowing 1 wei deposit that can be used for share price manipulation First depositor can manipulate share price by depositing 1 wei, donating assets directly to vault, causing rounding errors that steal from subsequent depositors.",
      "severity": "critical",
      "location": {
        "line": 16,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Protect 'mint' from share inflation attack. Solutions: (1) Mint initial shares to zero address on deployment (dead shares), (2) Implement virtual shares/assets (ERC4626 with offset), (3) Enforce minimum first deposit amount, (4) Use higher precision decimals (1e18 instead of 1e6).",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-extractable-value",
      "message": "Function 'mint' has extractable MEV. State changes visible in public mempool before execution, allowing MEV bots to react and extract value Searchers can extract value through transaction ordering, front-running, or back-running.",
      "severity": "high",
      "location": {
        "line": 16,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Reduce MEV extractability in 'mint'. Implement: (1) Commit-reveal schemes, (2) Batch processing/auctions, (3) Private transaction pools (Flashbots), (4) Time-weighted mechanisms, (5) MEV-resistant AMM curves, (6) Encrypted mempools.",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-extractable-value",
      "message": "Function 'issueTokens' has extractable MEV. State changes visible in public mempool before execution, allowing MEV bots to react and extract value Searchers can extract value through transaction ordering, front-running, or back-running.",
      "severity": "high",
      "location": {
        "line": 24,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Reduce MEV extractability in 'issueTokens'. Implement: (1) Commit-reveal schemes, (2) Batch processing/auctions, (3) Private transaction pools (Flashbots), (4) Time-weighted mechanisms, (5) MEV-resistant AMM curves, (6) Encrypted mempools.",
        "replacements": []
      }
    },
    {
      "detector_id": "token-supply-manipulation",
      "message": "Function 'mint' has token supply manipulation vulnerability. Mint function lacks maximum supply cap, enables unlimited token minting and hyperinflation Improper supply controls can lead to unlimited minting, hyperinflation, or complete token devaluation.",
      "severity": "critical",
      "location": {
        "line": 16,
        "column": 14,
        "length": 4
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Fix token supply controls in 'mint'. Implement maximum supply cap, add minting rate limits, require multi-signature for minting, add supply change events, validate burn amounts, and implement supply monitoring.",
        "replacements": []
      }
    },
    {
      "detector_id": "token-supply-manipulation",
      "message": "Function 'issueTokens' has token supply manipulation vulnerability. Function directly modifies totalSupply variable, bypasses mint/burn controls for supply manipulation Improper supply controls can lead to unlimited minting, hyperinflation, or complete token devaluation.",
      "severity": "critical",
      "location": {
        "line": 24,
        "column": 14,
        "length": 11
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Fix token supply controls in 'issueTokens'. Implement maximum supply cap, add minting rate limits, require multi-signature for minting, add supply change events, validate burn amounts, and implement supply monitoring.",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-token-mint-control",
      "message": "Unrestricted token minting in 'mint'",
      "severity": "critical",
      "location": {
        "line": 16,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add access control: modifier onlyBridge { require(msg.sender == bridge); _; }",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-token-mint-control",
      "message": "Unrestricted token minting in 'issueTokens'",
      "severity": "critical",
      "location": {
        "line": 24,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add access control: modifier onlyBridge { require(msg.sender == bridge); _; }",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.0;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 23
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.0;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "1.0.0",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "1.0.0"
  },
  "statistics": {
    "total_findings": 19,
    "severity_counts": {
      "critical": 6,
      "medium": 4,
      "low": 5,
      "info": 0,
      "high": 4
    },
    "unique_detectors": 8
  }
}

Analysis complete:
  Files analyzed: 1
  Successful: 1
  Issues found: 19
  Time taken: 0.00s

Exiting with code 1 due to:
  - Found high or critical severity issues
