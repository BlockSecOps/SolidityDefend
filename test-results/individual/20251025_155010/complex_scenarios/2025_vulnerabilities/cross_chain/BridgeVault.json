Loaded configuration from: .soliditydefend.yml
Starting analysis...
Analyzing: /Users/pwner/Git/ABS/SolidityDefend/tests/contracts/complex_scenarios/2025_vulnerabilities/cross_chain/BridgeVault.sol
  Found 125 issues
{
  "version": "1.0.0",
  "timestamp": "2025-10-25T21:50:11.592655Z",
  "findings": [
    {
      "detector_id": "missing-access-modifiers",
      "message": "Function 'transfer' performs critical operations but lacks access control modifiers",
      "severity": "critical",
      "location": {
        "line": 8,
        "column": 14,
        "length": 8
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier like 'onlyOwner' to function 'transfer'",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-access-modifiers",
      "message": "Function 'transferFrom' performs critical operations but lacks access control modifiers",
      "severity": "critical",
      "location": {
        "line": 9,
        "column": 14,
        "length": 12
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier like 'onlyOwner' to function 'transferFrom'",
        "replacements": []
      }
    },
    {
      "detector_id": "inefficient-storage",
      "message": "Inefficient storage pattern detected. Variable initialized with constant value but not marked as constant/immutable. Use constant or immutable Inefficient storage layout increases gas costs for all state-modifying operations.",
      "severity": "low",
      "location": {
        "line": 59,
        "column": 0,
        "length": 30
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize storage layout. Consider: (1) Pack variables <32 bytes together in structs, (2) Order struct fields by size (largest to smallest), (3) Use uint256 instead of smaller types for standalone variables, (4) Combine boolean flags into a single uint256 bitmap, (5) Use constants/immutables for unchanging values.",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'transfer' violates constant product invariant: Token transfers don't account for fee-on-transfer tokens, incorrect reserve calculations may result in pool drainage",
      "severity": "critical",
      "location": {
        "line": 8,
        "column": 14,
        "length": 8
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'transfer': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.20;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 24
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.20;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'address[]' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 175,
        "column": 0,
        "length": 9
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'address[]'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'require(targetAddress' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 117,
        "column": 0,
        "length": 21
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'require(targetAddress'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'IERC20(token).transferFrom(msg.sender,' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 142,
        "column": 0,
        "length": 38
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'IERC20(token).transferFrom(msg.sender,'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "multisig-bypass",
      "message": "Owner modification without threshold validation (inconsistent state)",
      "severity": "medium",
      "location": {
        "line": 0,
        "column": 0,
        "length": 20
      },
      "cwe": "CWE-347",
      "fix_suggestion": {
        "description": "Validate threshold: require(threshold <= ownerCount && threshold > 0, \"Invalid threshold\"); Adjust threshold when removing owners if needed.",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-access-modifiers",
      "message": "Function 'initiateBridge' performs critical operations but lacks access control modifiers",
      "severity": "critical",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier like 'onlyOwner' to function 'initiateBridge'",
        "replacements": []
      }
    },
    {
      "detector_id": "unprotected-initializer",
      "message": "Initializer function 'initiateBridge' lacks access control and can be called by anyone",
      "severity": "high",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-284",
      "fix_suggestion": {
        "description": "Add an access control modifier to 'initiateBridge' or ensure it can only be called once during deployment",
        "replacements": []
      }
    },
    {
      "detector_id": "classic-reentrancy",
      "message": "Function 'initiateBridge' may be vulnerable to reentrancy attacks due to state changes after external calls",
      "severity": "high",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Apply checks-effects-interactions pattern or use a reentrancy guard in function 'initiateBridge'",
        "replacements": []
      }
    },
    {
      "detector_id": "invalid-state-transition",
      "message": "State variables modified after external call - potential reentrancy affecting state machine",
      "severity": "critical",
      "location": {
        "line": 200,
        "column": 9,
        "length": 69
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Use checks-effects-interactions pattern or reentrancy guards",
        "replacements": []
      }
    },
    {
      "detector_id": "invalid-state-transition",
      "message": "State variables modified after external call - potential reentrancy affecting state machine",
      "severity": "critical",
      "location": {
        "line": 215,
        "column": 9,
        "length": 34
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Use checks-effects-interactions pattern or reentrancy guards",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'token' in function 'initiateBridge' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 109,
        "column": 17,
        "length": 5
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(token != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'targetAddress' in function 'initiateBridge' is not checked for zero address",
      "severity": "medium",
      "location": {
        "line": 112,
        "column": 17,
        "length": 13
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(targetAddress != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'token' in function 'emergencyWithdraw' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 209,
        "column": 17,
        "length": 5
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(token != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'to' in function 'emergencyWithdraw' is not checked for zero address",
      "severity": "high",
      "location": {
        "line": 211,
        "column": 17,
        "length": 2
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(to != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-zero-address-check",
      "message": "Address parameter 'bridgeAddress' in function 'addSupportedChain' is not checked for zero address",
      "severity": "medium",
      "location": {
        "line": 249,
        "column": 17,
        "length": 13
      },
      "cwe": "CWE-476",
      "fix_suggestion": {
        "description": "Add require(bridgeAddress != address(0), \"Zero address not allowed\");",
        "replacements": []
      }
    },
    {
      "detector_id": "array-bounds-check",
      "message": "Array access to '_validators' may be out of bounds - index not validated",
      "severity": "high",
      "location": {
        "line": 100,
        "column": 33,
        "length": 14
      },
      "cwe": "CWE-125",
      "fix_suggestion": {
        "description": "Add bounds check: require(index < _validators.length, \"Index out of bounds\");",
        "replacements": []
      }
    },
    {
      "detector_id": "array-bounds-check",
      "message": "Array access to 'newValidators' may be out of bounds - index not validated",
      "severity": "high",
      "location": {
        "line": 238,
        "column": 33,
        "length": 16
      },
      "cwe": "CWE-125",
      "fix_suggestion": {
        "description": "Add bounds check: require(index < newValidators.length, \"Index out of bounds\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'token' of type 'address' may need validation",
      "severity": "low",
      "location": {
        "line": 109,
        "column": 17,
        "length": 5
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(token != address(0), \"Invalid address\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'token' in function 'initiateBridge' may shadow a state variable",
      "severity": "medium",
      "location": {
        "line": 109,
        "column": 17,
        "length": 5
      },
      "cwe": "CWE-1177",
      "fix_suggestion": {
        "description": "Consider renaming parameter 'token' to avoid shadowing",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'token' of type 'address' may need validation",
      "severity": "low",
      "location": {
        "line": 209,
        "column": 17,
        "length": 5
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(token != address(0), \"Invalid address\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'amount' of type 'uint' may need validation",
      "severity": "low",
      "location": {
        "line": 210,
        "column": 17,
        "length": 6
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(amount > 0, \"Amount must be positive\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'to' of type 'address' may need validation",
      "severity": "low",
      "location": {
        "line": 211,
        "column": 17,
        "length": 2
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(to != address(0), \"Invalid address\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter ordering in function 'emergencyWithdraw': address parameter 'to' should typically come before amount parameter 'amount'",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-1188",
      "fix_suggestion": {
        "description": "Consider reordering parameters: address before amount",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'token' in function 'emergencyWithdraw' may shadow a state variable",
      "severity": "medium",
      "location": {
        "line": 209,
        "column": 17,
        "length": 5
      },
      "cwe": "CWE-1177",
      "fix_suggestion": {
        "description": "Consider renaming parameter 'token' to avoid shadowing",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'bridgeAddress' of type 'address' may need validation",
      "severity": "low",
      "location": {
        "line": 249,
        "column": 17,
        "length": 13
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(bridgeAddress != address(0), \"Invalid address\");",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'request' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 268,
        "column": 50,
        "length": 7
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'request' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'messageHash' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 278,
        "column": 36,
        "length": 11
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'messageHash' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'chainId' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 318,
        "column": 39,
        "length": 7
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'chainId' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "unchecked-external-call",
      "message": "External call in function 'completeBridge' does not check return value",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-252",
      "fix_suggestion": {
        "description": "Check the return value of external calls in function 'completeBridge'",
        "replacements": []
      }
    },
    {
      "detector_id": "unchecked-external-call",
      "message": "External call in function 'emergencyWithdraw' does not check return value",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-252",
      "fix_suggestion": {
        "description": "Check the return value of external calls in function 'emergencyWithdraw'",
        "replacements": []
      }
    },
    {
      "detector_id": "external-calls-loop",
      "message": "Function 'completeBridge' contains external calls within loops. This can lead to DoS attacks if any external call fails or consumes excessive gas, and can be exploited in governance systems to block proposal execution.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 0,
        "length": 14
      },
      "cwe": "CWE-834",
      "fix_suggestion": {
        "description": "Avoid external calls in loops. Consider using a withdrawal pattern, batch processing, or fail-safe mechanisms for critical operations.",
        "replacements": []
      }
    },
    {
      "detector_id": "signature-replay",
      "message": "Function '' verifies signatures without replay protection. Attackers can reuse valid signatures to perform unauthorized actions. This is particularly dangerous in governance systems for vote manipulation.",
      "severity": "high",
      "location": {
        "line": 93,
        "column": 0,
        "length": 0
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Implement a nonce system to prevent signature replay attacks. Include a unique nonce in the signed message and track used nonces.",
        "replacements": []
      }
    },
    {
      "detector_id": "signature-replay",
      "message": "Function 'recoverSigner' verifies signatures without replay protection. Attackers can reuse valid signatures to perform unauthorized actions. This is particularly dangerous in governance systems for vote manipulation.",
      "severity": "high",
      "location": {
        "line": 278,
        "column": 0,
        "length": 13
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Implement a nonce system to prevent signature replay attacks. Include a unique nonce in the signed message and track used nonces.",
        "replacements": []
      }
    },
    {
      "detector_id": "cross-chain-replay",
      "message": "Function 'completeBridge' generates hash/signature without chain ID protection. This allows the same signature to be replayed on different chains, potentially draining funds on all supported chains.",
      "severity": "critical",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Include 'block.chainid' in the hash calculation for function 'completeBridge'. Example: keccak256(abi.encodePacked(..., block.chainid))",
        "replacements": []
      }
    },
    {
      "detector_id": "weak-signature-validation",
      "message": "Function 'completeBridge' validates multiple signatures without checking for duplicates. An attacker can submit the same valid signature multiple times to meet the required signature threshold, bypassing multi-signature protection.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add duplicate signer check in function 'completeBridge'. Example: Track seen signers in a mapping or check array for duplicates. require(!seen[signer], \"Duplicate signer\"); seen[signer] = true;",
        "replacements": []
      }
    },
    {
      "detector_id": "emergency-function-abuse",
      "message": "Function 'emergencyWithdraw' is an emergency function without time-lock or multi-signature protection. A single admin can execute emergency actions immediately, enabling potential abuse or rug pulls.",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-269",
      "fix_suggestion": {
        "description": "Add time-lock and multi-sig protection to emergency function 'emergencyWithdraw'. Example: Require time-lock delay (e.g., 24-48 hours) and multi-signature approval before emergency actions can be executed.",
        "replacements": []
      }
    },
    {
      "detector_id": "signature-malleability",
      "message": "Function 'recoverSigner' uses ECDSA signature verification without malleability protection. Uses ecrecover without checking 's' value against secp256k1 curve order ECDSA signatures have two valid forms (s and -s mod n). Without checking that s is in the lower half range, attackers can create alternate valid signatures for replay attacks.",
      "severity": "high",
      "location": {
        "line": 278,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-347",
      "fix_suggestion": {
        "description": "Add signature malleability check in 'recoverSigner'. Use OpenZeppelin's ECDSA library or add: `require(uint256(s) <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0, \"Invalid signature 's' value\");` This ensures s is in the lower half of the curve order.",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-donation-attack",
      "message": "Function 'completeBridge' is vulnerable to vault donation attack. Uses balanceOf(address(this)) for share price calculation without internal balance tracking. Vulnerable to direct token donation manipulation Attacker can manipulate share price by directly transferring tokens to vault, causing rounding errors that steal from depositors.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Protect 'completeBridge' from donation attack. Solutions: (1) Track assets internally instead of using balanceOf, (2) Implement donation guards that track expected vs actual balance, (3) Use virtual shares/assets to make donations economically infeasible, (4) Require minimum initial deposits.",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-withdrawal-dos",
      "message": "Function 'emergencyWithdraw' is vulnerable to withdrawal DOS attack. No withdrawal cap or limit detected. Large withdrawals can drain liquidity and DOS subsequent withdrawers Attacker can block withdrawals, causing funds to be locked indefinitely.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Protect 'emergencyWithdraw' from withdrawal DOS. Solutions: (1) Implement withdrawal limits/caps per transaction, (2) Add circuit breakers for emergency withdrawals, (3) Avoid unbounded loops in withdrawal queue processing, (4) Implement partial withdrawal support, (5) Use pull-over-push pattern for failed withdrawals.",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-fee-manipulation",
      "message": "Function 'initiateBridge' is vulnerable to fee manipulation attack. Unprotected fee update without timelock. Fee changes take effect immediately, enabling front-running attacks Attacker can front-run fee changes to extract value from depositors.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect 'initiateBridge' from fee manipulation. Solutions: (1) Implement timelock delay on fee updates (24-48 hours), (2) Emit events before fee changes take effect, (3) Add maximum fee change limits per update, (4) Require multi-sig approval for fee changes, (5) Use gradual fee ramping instead of instant updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-fee-manipulation",
      "message": "Function 'updateBridgeFee' is vulnerable to fee manipulation attack. Fee update without event emission. Users cannot detect fee changes before they take effect Attacker can front-run fee changes to extract value from depositors.",
      "severity": "medium",
      "location": {
        "line": 259,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect 'updateBridgeFee' from fee manipulation. Solutions: (1) Implement timelock delay on fee updates (24-48 hours), (2) Emit events before fee changes take effect, (3) Add maximum fee change limits per update, (4) Require multi-sig approval for fee changes, (5) Use gradual fee ramping instead of instant updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "vault-hook-reentrancy",
      "message": "Function 'emergencyWithdraw' is vulnerable to hook reentrancy attack. Uses raw transfer() instead of SafeERC20. No protection against malicious token implementations with callback hooks ERC-777/ERC-1363 token callbacks can re-enter and manipulate vault state.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-841",
      "fix_suggestion": {
        "description": "Protect 'emergencyWithdraw' from hook reentrancy. Solutions: (1) Add nonReentrant modifier from OpenZeppelin, (2) Follow checks-effects-interactions pattern, (3) Update state before external calls with callbacks, (4) Validate token doesn't implement hooks (ERC-777/ERC-1363), (5) Use reentrancy guard on all vault entry points.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'initiateBridge' has dangerous timestamp dependency. Uses timestamp-based deadline without block.number as fallback, vulnerable to timestamp manipulation for deadline extensions Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'initiateBridge'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "timestamp-manipulation",
      "message": "Function 'completeBridge' has dangerous timestamp dependency. Uses timestamp-based deadline without block.number as fallback, vulnerable to timestamp manipulation for deadline extensions Miners can manipulate block.timestamp by ~15 seconds, enabling manipulation of time-sensitive logic.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Reduce timestamp dependency in 'completeBridge'. Use block.number for time intervals, add tolerance ranges (±15 seconds), implement commit-reveal schemes for time-sensitive operations, or use oracle-based time sources for critical logic.",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-extractable-value",
      "message": "Function 'initiateBridge' has extractable MEV. Public function with value transfer lacks MEV protection, enabling front-running and back-running attacks Searchers can extract value through transaction ordering, front-running, or back-running.",
      "severity": "high",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Reduce MEV extractability in 'initiateBridge'. Implement: (1) Commit-reveal schemes, (2) Batch processing/auctions, (3) Private transaction pools (Flashbots), (4) Time-weighted mechanisms, (5) MEV-resistant AMM curves, (6) Encrypted mempools.",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-extractable-value",
      "message": "Function 'completeBridge' has extractable MEV. Public function with value transfer lacks MEV protection, enabling front-running and back-running attacks Searchers can extract value through transaction ordering, front-running, or back-running.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Reduce MEV extractability in 'completeBridge'. Implement: (1) Commit-reveal schemes, (2) Batch processing/auctions, (3) Private transaction pools (Flashbots), (4) Time-weighted mechanisms, (5) MEV-resistant AMM curves, (6) Encrypted mempools.",
        "replacements": []
      }
    },
    {
      "detector_id": "mev-extractable-value",
      "message": "Function 'emergencyWithdraw' has extractable MEV. Public function with value transfer lacks MEV protection, enabling front-running and back-running attacks Searchers can extract value through transaction ordering, front-running, or back-running.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Reduce MEV extractability in 'emergencyWithdraw'. Implement: (1) Commit-reveal schemes, (2) Batch processing/auctions, (3) Private transaction pools (Flashbots), (4) Time-weighted mechanisms, (5) MEV-resistant AMM curves, (6) Encrypted mempools.",
        "replacements": []
      }
    },
    {
      "detector_id": "deadline-manipulation",
      "message": "Function 'initiateBridge' has deadline manipulation risk. Deadline parameter exists but is not validated against current time, allowing expired transactions to execute Validators can hold transactions and execute them at times that benefit MEV extraction or harm users.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Improve deadline handling in 'initiateBridge'. Use reasonable default deadlines (e.g., block.timestamp + 15 minutes), validate deadline parameters, add minimum deadline checks, or implement deadline extensions for failed transactions.",
        "replacements": []
      }
    },
    {
      "detector_id": "deadline-manipulation",
      "message": "Function 'completeBridge' has deadline manipulation risk. Deadline parameter exists but is not validated against current time, allowing expired transactions to execute Validators can hold transactions and execute them at times that benefit MEV extraction or harm users.",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-367",
      "fix_suggestion": {
        "description": "Improve deadline handling in 'completeBridge'. Use reasonable default deadlines (e.g., block.timestamp + 15 minutes), validate deadline parameters, add minimum deadline checks, or implement deadline extensions for failed transactions.",
        "replacements": []
      }
    },
    {
      "detector_id": "nonce-reuse",
      "message": "Function 'initiateBridge' has nonce management vulnerability. Uses global nonce instead of per-user mapping, forces sequential execution and limits parallelization Improper nonce handling enables replay attacks or transaction reordering exploits.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Fix nonce management in 'initiateBridge'. Increment nonce after validation, use mapping(address => uint256) for per-user nonces, validate nonce before execution, include nonce in signature hash, and implement nonce cancellation mechanism.",
        "replacements": []
      }
    },
    {
      "detector_id": "nonce-reuse",
      "message": "Function 'completeBridge' has nonce management vulnerability. Nonce reuse vulnerability marker detected Improper nonce handling enables replay attacks or transaction reordering exploits.",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Fix nonce management in 'completeBridge'. Increment nonce after validation, use mapping(address => uint256) for per-user nonces, validate nonce before execution, include nonce in signature hash, and implement nonce cancellation mechanism.",
        "replacements": []
      }
    },
    {
      "detector_id": "validator-griefing",
      "message": "Function '' has validator griefing vulnerability. Validators forced to participate in expensive operations, attacker can trigger high gas costs for all validators Attackers can harm validators without economic benefit, leading to validator exits and network destabilization.",
      "severity": "high",
      "location": {
        "line": 93,
        "column": 5,
        "length": 0
      },
      "cwe": "CWE-405",
      "fix_suggestion": {
        "description": "Mitigate validator griefing in ''. Implement griefing-cost mechanisms (deposit requirements), add rate limiting per address, require minimum stake for reporting, implement reputation systems, add penalties for false accusations, and create validator insurance pools.",
        "replacements": []
      }
    },
    {
      "detector_id": "validator-griefing",
      "message": "Function 'completeBridge' has validator griefing vulnerability. Validators forced to participate in expensive operations, attacker can trigger high gas costs for all validators Attackers can harm validators without economic benefit, leading to validator exits and network destabilization.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-405",
      "fix_suggestion": {
        "description": "Mitigate validator griefing in 'completeBridge'. Implement griefing-cost mechanisms (deposit requirements), add rate limiting per address, require minimum stake for reporting, implement reputation systems, add penalties for false accusations, and create validator insurance pools.",
        "replacements": []
      }
    },
    {
      "detector_id": "validator-griefing",
      "message": "Function 'updateValidators' has validator griefing vulnerability. No rate limiting on validator-affecting actions, allows spam attacks to overwhelm validators or slashing logic Attackers can harm validators without economic benefit, leading to validator exits and network destabilization.",
      "severity": "high",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-405",
      "fix_suggestion": {
        "description": "Mitigate validator griefing in 'updateValidators'. Implement griefing-cost mechanisms (deposit requirements), add rate limiting per address, require minimum stake for reporting, implement reputation systems, add penalties for false accusations, and create validator insurance pools.",
        "replacements": []
      }
    },
    {
      "detector_id": "withdrawal-delay",
      "message": "Function 'emergencyWithdraw' has withdrawal delay vulnerability. Withdrawal delay has no maximum cap, admin can set arbitrarily long delays locking funds indefinitely Improper withdrawal mechanisms can lock user funds indefinitely or enable denial of service.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Fix withdrawal mechanism in 'emergencyWithdraw'. Implement maximum withdrawal delay caps, add emergency withdrawal options with penalties, prevent admin from extending delays arbitrarily, implement fair queue systems, add partial withdrawal capabilities, and document clear withdrawal timelines.",
        "replacements": []
      }
    },
    {
      "detector_id": "validator-front-running",
      "message": "Function 'emergencyWithdraw' has validator front-running vulnerability. Price-sensitive operations without fair sequencing, validators can reorder transactions for MEV extraction Validators can observe pending transactions and extract value by front-running users.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Mitigate validator front-running in 'emergencyWithdraw'. Implement commit-reveal schemes, use threshold encryption, add validator rotation, implement fair sequencing service integration, use batch auctions instead of continuous, and add MEV redistribution mechanisms.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'onlyValidator' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 83,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'onlyValidator'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function '' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 93,
        "column": 5,
        "length": 0
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in ''. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'initiateBridge' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'initiateBridge'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'completeBridge' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'completeBridge'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'emergencyWithdraw' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'emergencyWithdraw'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'updateValidators' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'updateValidators'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'getMessageHash' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 268,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'getMessageHash'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "circular-dependency",
      "message": "Function 'recoverSigner' has circular dependency vulnerability. External contract calls without depth limit, circular calls can cause stack overflow Circular dependencies can cause stack overflow, DOS attacks, or make contracts unupgradeable.",
      "severity": "high",
      "location": {
        "line": 278,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-674",
      "fix_suggestion": {
        "description": "Break circular dependency in 'recoverSigner'. Use events instead of callbacks, implement depth limits for recursive calls, add reentrancy guards, use pull pattern instead of push, implement circuit breakers, and add visited tracking for graph traversal.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-griefing",
      "message": "Function 'initiateBridge' has gas griefing vulnerability. Transfer without gas stipend, recipient can grief by consuming gas in fallback Attackers can force users to waste gas or cause transactions to fail.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Mitigate gas griefing in 'initiateBridge'. Use pull pattern for transfers, limit array sizes, add gas stipends, implement gas-efficient loops, avoid unbounded operations, use OpenZeppelin SafeERC20.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-griefing",
      "message": "Function 'completeBridge' has gas griefing vulnerability. External call in loop without gas limit, attacker can grief by consuming all gas Attackers can force users to waste gas or cause transactions to fail.",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Mitigate gas griefing in 'completeBridge'. Use pull pattern for transfers, limit array sizes, add gas stipends, implement gas-efficient loops, avoid unbounded operations, use OpenZeppelin SafeERC20.",
        "replacements": []
      }
    },
    {
      "detector_id": "gas-griefing",
      "message": "Function 'emergencyWithdraw' has gas griefing vulnerability. Transfer without gas stipend, recipient can grief by consuming gas in fallback Attackers can force users to waste gas or cause transactions to fail.",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Mitigate gas griefing in 'emergencyWithdraw'. Use pull pattern for transfers, limit array sizes, add gas stipends, implement gas-efficient loops, avoid unbounded operations, use OpenZeppelin SafeERC20.",
        "replacements": []
      }
    },
    {
      "detector_id": "dos-unbounded-operation",
      "message": "Function 'updateValidators' has DOS vulnerability via unbounded operation. Deleting array or mapping without size limit, can exceed gas limit Can cause out-of-gas errors blocking contract functionality.",
      "severity": "high",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-834",
      "fix_suggestion": {
        "description": "Fix unbounded operation in 'updateValidators'. Add pagination for large loops, implement maximum iteration limits, use pull pattern instead of push, add circuit breakers, batch operations.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function '' contains excessive gas usage pattern. Storage array push operation inside loop. Extremely gas-intensive Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 93,
        "column": 5,
        "length": 0
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in ''. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function '' contains excessive gas usage pattern. Storage write operation inside loop. Consider using memory array Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 93,
        "column": 5,
        "length": 0
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in ''. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function '' contains excessive gas usage pattern. Array length read in every loop iteration. Cache length in local variable Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 93,
        "column": 5,
        "length": 0
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in ''. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'completeBridge' contains excessive gas usage pattern. Storage write operation inside loop. Consider using memory array Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'completeBridge'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'completeBridge' contains excessive gas usage pattern. Array length read in every loop iteration. Cache length in local variable Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'completeBridge'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'completeBridge' contains excessive gas usage pattern. Event emission inside loop. Can cause excessive gas costs for large arrays Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'completeBridge'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'updateValidators' contains excessive gas usage pattern. Storage array push operation inside loop. Extremely gas-intensive Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'updateValidators'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'updateValidators' contains excessive gas usage pattern. Storage write operation inside loop. Consider using memory array Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'updateValidators'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'updateValidators' contains excessive gas usage pattern. Storage deletion inside loop. Each delete costs significant gas Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'updateValidators'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "excessive-gas-usage",
      "message": "Function 'updateValidators' contains excessive gas usage pattern. Array length read in every loop iteration. Cache length in local variable Excessive gas usage increases transaction costs and may cause out-of-gas errors.",
      "severity": "low",
      "location": {
        "line": 221,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize gas usage in 'updateValidators'. Consider: (1) Move storage operations outside loops, (2) Cache storage reads in memory, (3) Use events instead of storage for historical data, (4) Pack struct variables efficiently, (5) Use memory arrays for temporary data.",
        "replacements": []
      }
    },
    {
      "detector_id": "inefficient-storage",
      "message": "Inefficient storage pattern detected. Variable initialized with constant value but not marked as constant/immutable. Use constant or immutable Inefficient storage layout increases gas costs for all state-modifying operations.",
      "severity": "low",
      "location": {
        "line": 59,
        "column": 0,
        "length": 30
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Optimize storage layout. Consider: (1) Pack variables <32 bytes together in structs, (2) Order struct fields by size (largest to smallest), (3) Use uint256 instead of smaller types for standalone variables, (4) Combine boolean flags into a single uint256 bitmap, (5) Use constants/immutables for unchanging values.",
        "replacements": []
      }
    },
    {
      "detector_id": "redundant-checks",
      "message": "Function '' contains redundant checks. 3 consecutive require statements. Consider combining into fewer checks Redundant checks waste gas and increase transaction costs unnecessarily.",
      "severity": "low",
      "location": {
        "line": 93,
        "column": 5,
        "length": 0
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Remove redundant checks in ''. Consider: (1) Eliminate duplicate require() statements, (2) Combine multiple checks into single require(), (3) Remove overflow checks in Solidity >=0.8, (4) Avoid checking same condition in modifier and function, (5) Use custom errors instead of require with strings.",
        "replacements": []
      }
    },
    {
      "detector_id": "redundant-checks",
      "message": "Function 'initiateBridge' contains redundant checks. Manual overflow/underflow check in Solidity 0.8+. Built-in protection makes this redundant Redundant checks waste gas and increase transaction costs unnecessarily.",
      "severity": "low",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Remove redundant checks in 'initiateBridge'. Consider: (1) Eliminate duplicate require() statements, (2) Combine multiple checks into single require(), (3) Remove overflow checks in Solidity >=0.8, (4) Avoid checking same condition in modifier and function, (5) Use custom errors instead of require with strings.",
        "replacements": []
      }
    },
    {
      "detector_id": "redundant-checks",
      "message": "Function 'initiateBridge' contains redundant checks. 3 consecutive require statements. Consider combining into fewer checks Redundant checks waste gas and increase transaction costs unnecessarily.",
      "severity": "low",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Remove redundant checks in 'initiateBridge'. Consider: (1) Eliminate duplicate require() statements, (2) Combine multiple checks into single require(), (3) Remove overflow checks in Solidity >=0.8, (4) Avoid checking same condition in modifier and function, (5) Use custom errors instead of require with strings.",
        "replacements": []
      }
    },
    {
      "detector_id": "centralization-risk",
      "message": "Function 'emergencyWithdraw' has centralization risk. Emergency function 'emergencyWithdraw' lacks multi-party approval. Can be abused by single compromised key Critical function controlled by single address creates attack vector.",
      "severity": "high",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-269",
      "fix_suggestion": {
        "description": "Add decentralization to 'emergencyWithdraw'. Implement multi-signature requirements, timelock delays, or DAO governance for this critical function.",
        "replacements": []
      }
    },
    {
      "detector_id": "insufficient-randomness",
      "message": "Function 'initiateBridge' uses weak randomness source. Uses block.timestamp for randomness generation. Miners can manipulate timestamp within ~15 second range to influence outcome Predictable randomness enables attackers to manipulate outcomes in lotteries, games, or selection processes.",
      "severity": "high",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-338",
      "fix_suggestion": {
        "description": "Use secure randomness in 'initiateBridge'. Implement: (1) Chainlink VRF for verifiable randomness, (2) Commit-reveal scheme with multi-block delay, (3) External oracle for random number generation, (4) Avoid block.timestamp, blockhash, or block.number, (5) Use Randao for Ethereum 2.0.",
        "replacements": []
      }
    },
    {
      "detector_id": "insufficient-randomness",
      "message": "Function 'completeBridge' uses weak randomness source. Uses block.timestamp for randomness generation. Miners can manipulate timestamp within ~15 second range to influence outcome Predictable randomness enables attackers to manipulate outcomes in lotteries, games, or selection processes.",
      "severity": "high",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-338",
      "fix_suggestion": {
        "description": "Use secure randomness in 'completeBridge'. Implement: (1) Chainlink VRF for verifiable randomness, (2) Commit-reveal scheme with multi-block delay, (3) External oracle for random number generation, (4) Avoid block.timestamp, blockhash, or block.number, (5) Use Randao for Ethereum 2.0.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Parameter 'token' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Parameter 'amount' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Parameter 'targetChain' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Local variable 'deadline' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Local variable '\"Invalid' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Local variable 'nonce' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Local variable 'fee' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Local variable 'bridgeAmount' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'initiateBridge' contains variable shadowing. Local variable 'amount)' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'initiateBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'completeBridge' contains variable shadowing. Local variable 'memory' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'completeBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'completeBridge' contains variable shadowing. Local variable 'signer' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'completeBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'completeBridge' contains variable shadowing. Local variable 'availableBalance' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'completeBridge'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'emergencyWithdraw' contains variable shadowing. Parameter 'token' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'emergencyWithdraw'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'emergencyWithdraw' contains variable shadowing. Parameter 'amount' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'emergencyWithdraw'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'recoverSigner' contains variable shadowing. Local variable 'v' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 278,
        "column": 14,
        "length": 13
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'recoverSigner'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-input-validation",
      "message": "Function 'emergencyWithdraw' missing input validation. Critical function with address parameter lacks zero address validation Missing validation can lead to unexpected behavior, zero address transfers, or invalid state.",
      "severity": "medium",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "Add input validation to 'emergencyWithdraw'. Implement: (1) Zero address checks for address parameters, (2) Bounds validation for numeric inputs, (3) Array length validation, (4) require() statements at function start, (5) OpenZeppelin Address library for address validation.",
        "replacements": []
      }
    },
    {
      "detector_id": "unsafe-type-casting",
      "message": "Function 'completeBridge' contains unsafe type casting. address type casting without validation. May result in zero address Unsafe type conversions can lead to data loss, value truncation, or unexpected behavior.",
      "severity": "medium",
      "location": {
        "line": 196,
        "column": 0,
        "length": 20
      },
      "cwe": "CWE-704",
      "fix_suggestion": {
        "description": "Add safe type casting in 'completeBridge'. Implement: (1) Validate value ranges before casting, (2) Use require() to check bounds, (3) Use SafeCast library from OpenZeppelin, (4) Avoid downcasting without validation, (5) Check for sign preservation in int/uint conversions.",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'initiateBridge' violates constant product invariant: Token transfers don't account for fee-on-transfer tokens, incorrect reserve calculations may result in pool drainage; K invariant check doesn't account for fees, may incorrectly reject valid swaps or allow invalid ones",
      "severity": "critical",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'initiateBridge': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'completeBridge' violates constant product invariant: Reserve updates don't sync with actual token balances, may cause discrepancies with fee-on-transfer tokens",
      "severity": "critical",
      "location": {
        "line": 153,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'completeBridge': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'emergencyWithdraw' violates constant product invariant: Token transfers don't account for fee-on-transfer tokens, incorrect reserve calculations may result in pool drainage",
      "severity": "critical",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'emergencyWithdraw': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "amm-k-invariant-violation",
      "message": "AMM function 'updateBridgeFee' violates constant product invariant: K invariant check doesn't account for fees, may incorrectly reject valid swaps or allow invalid ones",
      "severity": "critical",
      "location": {
        "line": 259,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure AMM function 'updateBridgeFee': Validate K invariant (reserve0 * reserve1 >= kBefore), handle fee-on-transfer tokens by measuring actual balances, update reserves atomically with reentrancy protection, add slippage protection and deadline checks",
        "replacements": []
      }
    },
    {
      "detector_id": "lending-borrow-bypass",
      "message": "Lending protocol function 'emergencyWithdraw' has borrow bypass vulnerabilities: Collateral withdrawal doesn't validate health factor after removal, may allow withdrawal that causes undercollateralization",
      "severity": "critical",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-682",
      "fix_suggestion": {
        "description": "Secure lending function 'emergencyWithdraw': Calculate and validate health factor before borrow, enforce collateral factor (LTV) limits, add reentrancy guards, implement same-block borrow restrictions for flash loans, update state before external calls (checks-effects-interactions pattern)",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.20;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 24
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.20;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'IERC20(token).transferFrom(msg.sender,' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 142,
        "column": 0,
        "length": 38
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'IERC20(token).transferFrom(msg.sender,'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'require(targetAddress' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 117,
        "column": 0,
        "length": 21
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'require(targetAddress'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'address[]' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 175,
        "column": 0,
        "length": 9
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'address[]'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'emergencyWithdraw' finalizes withdrawals without proper checks. No finality check before withdrawal. Should verify L2 state is finalized Missing validation can allow premature or unauthorized withdrawals.",
      "severity": "critical",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add finality checks to 'emergencyWithdraw': (1) Verify sufficient block confirmations, (2) Check withdrawal was properly initiated on L2, (3) Validate proof of L2 state, (4) Prevent replay with nonce tracking.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'emergencyWithdraw' finalizes withdrawals without proper checks. Missing withdrawal proof validation. Should verify withdrawal was initiated on L2 Missing validation can allow premature or unauthorized withdrawals.",
      "severity": "critical",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add finality checks to 'emergencyWithdraw': (1) Verify sufficient block confirmations, (2) Check withdrawal was properly initiated on L2, (3) Validate proof of L2 state, (4) Prevent replay with nonce tracking.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'emergencyWithdraw' finalizes withdrawals without proper checks. Missing replay protection. Withdrawals could be claimed multiple times Missing validation can allow premature or unauthorized withdrawals.",
      "severity": "critical",
      "location": {
        "line": 208,
        "column": 14,
        "length": 17
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add finality checks to 'emergencyWithdraw': (1) Verify sufficient block confirmations, (2) Check withdrawal was properly initiated on L2, (3) Validate proof of L2 state, (4) Prevent replay with nonce tracking.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'initiateBridge' updates fees without proper protections. No access control on fee updates. Anyone can modify fees leading to manipulation Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'initiateBridge': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'initiateBridge' updates fees without proper protections. No rate limiting on fee updates. Fees could be changed too frequently causing instability Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 108,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'initiateBridge': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'updateBridgeFee' updates fees without proper protections. No access control on fee updates. Anyone can modify fees leading to manipulation Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 259,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'updateBridgeFee': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'updateBridgeFee' updates fees without proper protections. No event emission for fee updates. Users cannot track fee changes or prepare for them Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 259,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'updateBridgeFee': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'updateBridgeFee' updates fees without proper protections. No rate limiting on fee updates. Fees could be changed too frequently causing instability Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 259,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'updateBridgeFee': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-fee-manipulation",
      "message": "Function 'updateBridgeFee' updates fees without proper protections. No validation of new fee value. Should enforce reasonable bounds on fee changes Vulnerable fee updates can be front-run or manipulated to extract value.",
      "severity": "medium",
      "location": {
        "line": 259,
        "column": 14,
        "length": 15
      },
      "cwe": "CWE-362",
      "fix_suggestion": {
        "description": "Protect fee updates in 'updateBridgeFee': (1) Implement time-delayed fee changes with announcement period, (2) Add governance or multi-sig control for fee updates, (3) Limit rate of fee changes (e.g., max 10% per day), (4) Emit events before fee changes take effect, (5) Consider using commit-reveal scheme for fee updates.",
        "replacements": []
      }
    },
    {
      "detector_id": "multisig-bypass",
      "message": "Owner modification without threshold validation (inconsistent state)",
      "severity": "medium",
      "location": {
        "line": 0,
        "column": 0,
        "length": 20
      },
      "cwe": "CWE-347",
      "fix_suggestion": {
        "description": "Validate threshold: require(threshold <= ownerCount && threshold > 0, \"Invalid threshold\"); Adjust threshold when removing owners if needed.",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "1.0.0",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "1.0.0"
  },
  "statistics": {
    "total_findings": 125,
    "severity_counts": {
      "high": 37,
      "medium": 45,
      "info": 0,
      "critical": 15,
      "low": 28
    },
    "unique_detectors": 43
  }
}

Analysis complete:
  Files analyzed: 1
  Successful: 1
  Issues found: 125
  Time taken: 0.05s

Exiting with code 1 due to:
  - Found high or critical severity issues
