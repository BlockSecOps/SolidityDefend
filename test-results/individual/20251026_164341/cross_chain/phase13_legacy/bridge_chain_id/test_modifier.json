Loaded configuration from: .soliditydefend.yml
Starting analysis...
Analyzing: /Users/pwner/Git/ABS/SolidityDefend/tests/contracts/cross_chain/phase13_legacy/bridge_chain_id/test_modifier.sol
  Found 9 issues
{
  "version": "0.8.0",
  "timestamp": "2025-10-26T22:43:44.199335Z",
  "findings": [
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'message' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 21,
        "column": 45,
        "length": 7
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'message' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "cross-chain-replay",
      "message": "Function 'receiveMessage' generates hash/signature without chain ID protection. This allows the same signature to be replayed on different chains, potentially draining funds on all supported chains.",
      "severity": "critical",
      "location": {
        "line": 12,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Include 'block.chainid' in the hash calculation for function 'receiveMessage'. Example: keccak256(abi.encodePacked(..., block.chainid))",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-message-verification",
      "message": "Missing message verification in 'receiveMessage'",
      "severity": "critical",
      "location": {
        "line": 12,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add verification: require(verifyMerkleProof(root, proof, leaf) OR ecrecover(hash, v, r, s) == signer);",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-chainid-validation",
      "message": "Missing chain-ID validation in 'receiveMessage'",
      "severity": "medium",
      "location": {
        "line": 12,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add runtime validation: require(message.destinationChainId == block.chainid);",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.0;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 23
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.0;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    },
    {
      "detector_id": "unused-state-variables",
      "message": "State variable 'hash' is declared but never used. Unused state variables waste storage slots and increase deployment gas costs. Each unused storage slot costs gas during deployment.",
      "severity": "low",
      "location": {
        "line": 17,
        "column": 0,
        "length": 4
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused state variable 'hash'. If this variable is intended for future use, consider adding a TODO comment. If it needs to maintain storage layout for upgradeable contracts, add a comment explaining this.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'receiveMessage' relays cross-layer messages without proper validation. Missing Merkle proof validation. Messages should verify against L2 state root This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 12,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'receiveMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'receiveMessage' relays cross-layer messages without proper validation. No finality check detected. Should verify sufficient block confirmations before execution This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 12,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'receiveMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'receiveMessage' relays cross-layer messages without proper validation. Missing nonce or sequence validation. Vulnerable to replay attacks This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 12,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'receiveMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "0.8.0",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "0.8.0"
  },
  "statistics": {
    "total_findings": 9,
    "severity_counts": {
      "critical": 5,
      "medium": 2,
      "high": 0,
      "info": 0,
      "low": 2
    },
    "unique_detectors": 7
  }
}

Analysis complete:
  Files analyzed: 1
  Successful: 1
  Issues found: 9
  Time taken: 0.00s

Exiting with code 1 due to:
  - Found high or critical severity issues
