Loaded configuration from: .soliditydefend.yml
Starting analysis...
Analyzing: /Users/pwner/Git/ABS/SolidityDefend/tests/contracts/cross_chain/phase13_legacy/bridge_chain_id/clean.sol
  Found 18 issues
{
  "version": "0.8.0",
  "timestamp": "2025-10-26T22:43:43.904528Z",
  "findings": [
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'message' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 83,
        "column": 45,
        "length": 7
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'message' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'message' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 87,
        "column": 45,
        "length": 7
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'message' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'hash' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 91,
        "column": 39,
        "length": 4
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'hash' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'signature' is declared but never used",
      "severity": "medium",
      "location": {
        "line": 91,
        "column": 60,
        "length": 9
      },
      "cwe": "CWE-563",
      "fix_suggestion": {
        "description": "Remove unused parameter 'signature' or use it in the function",
        "replacements": []
      }
    },
    {
      "detector_id": "test-governance",
      "message": "Function 'executeOnDeploymentChain' lacks time-delay protection for governance actions. New token holders can immediately use their voting power, enabling flash loan governance attacks.",
      "severity": "medium",
      "location": {
        "line": 75,
        "column": 0,
        "length": 24
      },
      "cwe": "CWE-662",
      "fix_suggestion": {
        "description": "Implement time-delayed voting rights requiring minimum holding periods.",
        "replacements": []
      }
    },
    {
      "detector_id": "test-governance",
      "message": "Function '_executeMessage' lacks time-delay protection for governance actions. New token holders can immediately use their voting power, enabling flash loan governance attacks.",
      "severity": "medium",
      "location": {
        "line": 83,
        "column": 0,
        "length": 15
      },
      "cwe": "CWE-662",
      "fix_suggestion": {
        "description": "Implement time-delayed voting rights requiring minimum holding periods.",
        "replacements": []
      }
    },
    {
      "detector_id": "signature-replay",
      "message": "Function 'receiveMessage' verifies signatures without replay protection. Attackers can reuse valid signatures to perform unauthorized actions. This is particularly dangerous in governance systems for vote manipulation.",
      "severity": "high",
      "location": {
        "line": 45,
        "column": 0,
        "length": 14
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Implement a nonce system to prevent signature replay attacks. Include a unique nonce in the signed message and track used nonces.",
        "replacements": []
      }
    },
    {
      "detector_id": "signature-replay",
      "message": "Function '_verifySignature' verifies signatures without replay protection. Attackers can reuse valid signatures to perform unauthorized actions. This is particularly dangerous in governance systems for vote manipulation.",
      "severity": "high",
      "location": {
        "line": 91,
        "column": 0,
        "length": 16
      },
      "cwe": "CWE-294",
      "fix_suggestion": {
        "description": "Implement a nonce system to prevent signature replay attacks. Include a unique nonce in the signed message and track used nonces.",
        "replacements": []
      }
    },
    {
      "detector_id": "redundant-checks",
      "message": "Function 'receiveMessage' contains redundant checks. 3 consecutive require statements. Consider combining into fewer checks Redundant checks waste gas and increase transaction costs unnecessarily.",
      "severity": "low",
      "location": {
        "line": 45,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-400",
      "fix_suggestion": {
        "description": "Remove redundant checks in 'receiveMessage'. Consider: (1) Eliminate duplicate require() statements, (2) Combine multiple checks into single require(), (3) Remove overflow checks in Solidity >=0.8, (4) Avoid checking same condition in modifier and function, (5) Use custom errors instead of require with strings.",
        "replacements": []
      }
    },
    {
      "detector_id": "shadowing-variables",
      "message": "Function 'executeOnDeploymentChain' contains variable shadowing. Local variable 'success,)' shadows state variable Shadowing can cause confusion and lead to bugs where the wrong variable is accessed.",
      "severity": "medium",
      "location": {
        "line": 75,
        "column": 14,
        "length": 24
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Rename shadowing variables in 'executeOnDeploymentChain'. Use different names for local variables to avoid shadowing state variables. Consider prefixes like '_' for function parameters or descriptive names.",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-message-verification",
      "message": "Missing message verification in 'processMessage'",
      "severity": "critical",
      "location": {
        "line": 26,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add verification: require(verifyMerkleProof(root, proof, leaf) OR ecrecover(hash, v, r, s) == signer);",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-message-verification",
      "message": "Missing message verification in 'executeOnDeploymentChain'",
      "severity": "critical",
      "location": {
        "line": 75,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add verification: require(verifyMerkleProof(root, proof, leaf) OR ecrecover(hash, v, r, s) == signer);",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.0;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 23
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.0;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'processMessage' relays cross-layer messages without proper validation. Missing Merkle proof validation. Messages should verify against L2 state root This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 26,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'processMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'processMessage' relays cross-layer messages without proper validation. No finality check detected. Should verify sufficient block confirmations before execution This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 26,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'processMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'processMessage' relays cross-layer messages without proper validation. Missing nonce or sequence validation. Vulnerable to replay attacks This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 26,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'processMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'receiveMessage' relays cross-layer messages without proper validation. No finality check detected. Should verify sufficient block confirmations before execution This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 45,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'receiveMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    },
    {
      "detector_id": "l2-bridge-message-validation",
      "message": "Function 'receiveMessage' relays cross-layer messages without proper validation. Missing nonce or sequence validation. Vulnerable to replay attacks This can lead to unauthorized message execution and bridge exploits.",
      "severity": "critical",
      "location": {
        "line": 45,
        "column": 14,
        "length": 14
      },
      "cwe": "CWE-345",
      "fix_suggestion": {
        "description": "Add proper validation to 'receiveMessage': (1) Verify Merkle proof against L1/L2 state root, (2) Check message finality (block confirmations), (3) Implement nonce/sequence tracking to prevent replay, (4) Validate message signatures, (5) Add cross-chain replay protection.",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "0.8.0",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "0.8.0"
  },
  "statistics": {
    "total_findings": 18,
    "severity_counts": {
      "critical": 7,
      "high": 2,
      "medium": 7,
      "info": 0,
      "low": 2
    },
    "unique_detectors": 8
  }
}

Analysis complete:
  Files analyzed: 1
  Successful: 1
  Issues found: 18
  Time taken: 0.01s

Exiting with code 1 due to:
  - Found high or critical severity issues
