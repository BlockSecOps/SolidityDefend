Loaded configuration from: .soliditydefend.yml
Starting analysis...
Analyzing: /Users/pwner/Git/ABS/SolidityDefend/tests/contracts/cross_chain/phase13_legacy/bridge_message_verification/test_merkle.sol
  Found 7 issues
{
  "version": "0.8.0",
  "timestamp": "2025-10-26T22:43:44.574662Z",
  "findings": [
    {
      "detector_id": "parameter-consistency",
      "message": "Parameter 'proof' of type 'array' may need validation",
      "severity": "medium",
      "location": {
        "line": 8,
        "column": 28,
        "length": 5
      },
      "cwe": "CWE-20",
      "fix_suggestion": {
        "description": "require(proof.length > 0, \"Array cannot be empty\");",
        "replacements": []
      }
    },
    {
      "detector_id": "test-governance",
      "message": "Function 'executeWithProof' lacks time-delay protection for governance actions. New token holders can immediately use their voting power, enabling flash loan governance attacks.",
      "severity": "medium",
      "location": {
        "line": 5,
        "column": 0,
        "length": 16
      },
      "cwe": "CWE-662",
      "fix_suggestion": {
        "description": "Implement time-delayed voting rights requiring minimum holding periods.",
        "replacements": []
      }
    },
    {
      "detector_id": "test-governance",
      "message": "Function '_execute' lacks time-delay protection for governance actions. New token holders can immediately use their voting power, enabling flash loan governance attacks.",
      "severity": "medium",
      "location": {
        "line": 18,
        "column": 0,
        "length": 8
      },
      "cwe": "CWE-662",
      "fix_suggestion": {
        "description": "Implement time-delayed voting rights requiring minimum holding periods.",
        "replacements": []
      }
    },
    {
      "detector_id": "uninitialized-storage",
      "message": "Function 'executeWithProof' contains uninitialized storage pointer. Declares array variable without memory/storage keyword or initialization Uninitialized local struct/array variables default to storage and point to slot 0, potentially corrupting critical state variables.",
      "severity": "high",
      "location": {
        "line": 5,
        "column": 14,
        "length": 16
      },
      "cwe": "CWE-824",
      "fix_suggestion": {
        "description": "Initialize storage pointers in 'executeWithProof'. Use `memory` keyword for local variables or explicitly assign to storage. Example: `MyStruct memory data = MyStruct(...)` or ensure initialization before use.",
        "replacements": []
      }
    },
    {
      "detector_id": "bridge-message-verification",
      "message": "Missing replay protection in 'executeWithProof'",
      "severity": "critical",
      "location": {
        "line": 5,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add: require(!processedMessages[msgHash]); processedMessages[msgHash] = true;",
        "replacements": []
      }
    },
    {
      "detector_id": "missing-chainid-validation",
      "message": "Missing chain-ID validation in 'executeWithProof'",
      "severity": "high",
      "location": {
        "line": 5,
        "column": 0,
        "length": 20
      },
      "fix_suggestion": {
        "description": "Add chain-ID validation: require(message.destinationChainId == block.chainid); OR include chain-ID in message hash",
        "replacements": []
      }
    },
    {
      "detector_id": "floating-pragma",
      "message": "Floating pragma detected: pragma solidity ^0.8.0;. Using '^' allows compilation with multiple compiler versions, which may introduce unexpected behavior or security vulnerabilities. Different compiler versions may have different bugs, optimizations, or security fixes.",
      "severity": "low",
      "location": {
        "line": 2,
        "column": 0,
        "length": 23
      },
      "cwe": "CWE-710",
      "fix_suggestion": {
        "description": "Lock pragma to specific version: 'pragma solidity 0.8.0;'. This ensures consistent compilation across environments and prevents unexpected behavior from compiler version differences.",
        "replacements": []
      }
    }
  ],
  "metadata": {
    "tool_name": "SolidityDefend",
    "tool_version": "0.8.0",
    "scan_type": "static_analysis",
    "language": "solidity",
    "rules_version": "0.8.0"
  },
  "statistics": {
    "total_findings": 7,
    "severity_counts": {
      "low": 1,
      "critical": 1,
      "high": 2,
      "medium": 3,
      "info": 0
    },
    "unique_detectors": 6
  }
}

Analysis complete:
  Files analyzed: 1
  Successful: 1
  Issues found: 7
  Time taken: 0.00s

Exiting with code 1 due to:
  - Found high or critical severity issues
